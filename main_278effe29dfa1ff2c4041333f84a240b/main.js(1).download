(function(){this.Blue||(this.Blue={version:{},buildDate:{}}),this.Blue.version["blue/main"]="2.19.1",this.Blue.buildDate["blue/main"]="2019-07-19T19:48:08.994Z"}).call(this),requirejs.config({waitSeconds:60,map:{"*":{"mout/random/random":"blue/random"}}}),define("blue/config",function(){}),function(){function e(){var e=!1,t=[];return{then:function(n){if(void 0===n||"function"==typeof n)return e&&n?void n.call(this):void t.push(n)},resolve:function(){return t&&t.forEach(function(e){e.call(this)}),t=[],e=!0,this}}}this.Blue||(this.Blue={version:{},buildDate:{}}),this.Blue.network={stats:{speed:0,isOnline:!0}},this.Blue.minified=function e(){return e.toString().length<60}(),define("blue/index",[],function(){return this.Blue}),this.Blue.status={applicationLoaded:new e}}.call(),define("blue/as/serializable",[],function(){"use strict";function e(e){this.toJSON=e||function(){return"missing serializer"},this.toString=function(){return this.toJSON()}}return e}),define("blue/root",[],function(){return function(){return this}.call()}),define("blue/perf",["require","blue/root"],function(require){"use strict";var data,methods,lastRoute,snapshots,debugRx,traceRx,v="1.2.1",root=require("blue/root"),noop=function(){return noop},perf=root.performance||{},perfNow=perf.now&&perf.now.bind(perf),perfMark=perf.mark?perf.mark.bind(perf):noop,getDtm=perfNow||Date.now.bind(Date),dtmCnt=0,dtmStart=getDtm(),dtmLastEvent=dtmStart,dtmLastRoute=dtmStart,options={},originals={console:{},func:{}},consoleLevels={none:7,error:6,warn:5,info:4,log:3,debug:2,trace:1,all:0},routeHistory=[],ui,pad=function(e,t,n){return(new Array(t||0).join(n||" ")+e).slice(-t)},formatNumber=function(e,t){return e.toFixed(t||0).replace(/(\d)(?=(\d{3})+$)/g,"$1,")},internals={console:function(e,t){(originals.console[e]||root.console[e]||noop).apply(root.console,t)},setTimeout:function(){return(originals.setTimeout||root.setTimeout).apply(root,arguments)},setInterval:function(){return(originals.setInterval||root.setInterval).apply(root,arguments)}},getObject=function(e,t,n){return e[t]&&"function"!=typeof e[t]?e[t]:e[t]=n},buildTree=function(e,t){var n=""+t.shift();e[n]=getObject(e,n,{_cnt:0,_time:0}),e[n]._cnt++,t.length&&buildTree(e[n],t)},addTime=function(e,t,n,r){var o=""+t.shift();e[o]._time+=n,t.length?addTime(e[o],t,n,r):r&&delete e[o]},getRoutes=function(e){var t={},n=function(e,t){var r,o,i,a=0;for(r in e)switch(r){case"_cnt":case"_time":break;case"*:cnt":case"*:ms":t[r]=e[r];break;default:a++,o=e[r],i=o._time?" | "+formatNumber(o._time)+"ms ":" ",t["["+r+"] "+formatNumber(o._cnt)+i]=n(o,{})}return a?t:""};return e?n(data.routes[e],t):data.routes},resetRoutes=function(e){e?delete data.routes[e]:data.routes={}},getLeaked=function(){var e,t,n,r,o,i,a,s={"*":0};for(e in data.track)if("*"!==e&&-1===e.indexOf("\u27a1")){s[e]=0,t=e+" \u27a1",n=data.track[t],r=getObject(s,t,{});for(i in n)a=n[i],a.history!==routeHistory.length&&(o=getObject(r,a.history+" - "+routeHistory[a.history-1],{}),s[e]++,s["*"]++,o[i]=a)}return s},getHooks=function(){var e,t,n={"*":0},r=jQuery&&jQuery._data_priv_cache||{};return Object.keys(r).forEach(function(o){e=r[o],e.events&&(t=getObject(n,o,{}),Object.keys(e.events).forEach(function(r){t[r]=e.events[r][0].handler,n["*"]++}))}),n},getTimers=function(){var e,t=0,n=function(e,t){return e+t},r=originals.setIntervalIndex,o=originals.setTimeoutIndex,i={setIntervals:r,setTimeouts:o};for(e in r)isNaN(e)||(t+=1e3/r[e].interval);return i.intervalsPerSecond=t,o.timeline.unshift(0),o.timeline.length>5&&o.timeline.pop(),t=o.timeline.reduce(n,0)/o.timeline.length*2,i.timeoutsPerSecond=t,i},track=function(e,t,n){var r=""+t,o=e+" \u27a1",i=getObject(data.track,e,0),a=getObject(data.track,o,{}),s=a[r];data.track[e]=i,n?(s?internals.console("error",["tracked item overwritten",e,t,n]):(data.track["*"]++,data.track[e]++),a[r]={ref:n,history:routeHistory.length,dtm:getDtm()}):(s?(data.track["*"]--,data.track[e]--):internals.console("warn",["tracked item destroyed multiple times",e,t,n]),delete a[r])},test=function(e,t,n){var r,o;for(r=e.length;r--;)switch(typeof(o=e[r])){case"object":if(o.test(t))return!0;break;case"function":if(o(t,n))return!0}return!1},snapshot=function(e){var t={};if(e?t[e]=getRoutes(e):t=getRoutes(),options.output)if(e){var n=getLeaked(),r=getHooks(),o=getTimers(),i={log:"background:#eee;",info:"background:#cff;border:1px solid #999;padding: 0 4px;",warn:"background:#ffc;border:1px solid #999;padding: 0 4px;",error:"background:#fcc;border:1px solid #999;padding: 0 4px;"},a=["%c!PERF/SNAPSHOT #"+routeHistory.length+"%c %c"+formatNumber(t[e]["*:cnt"])+"%c %c"+(options.lifecycle?formatNumber(data.track["*"]):"-")+"%c %c"+(options.lifecycle?formatNumber(n["*"]):"-")+"%c %c"+(options.hooks?formatNumber(r["*"]):"-")+"%c %c"+e,i.log,"",i.info,"",i.warn,"",i.error,"",i.error,"",i.log];internals.console("groupCollapsed",a),internals.console("log",["%c!PERF/EVENTS:  %s events   %O","background:#cff;",pad(formatNumber(t[e]["*:cnt"]),7),t[e]]),options.lifecycle&&internals.console("log",["%c!PERF/TRACKED: %s items    %O","background:#ffc;",pad(formatNumber(data.track["*"]),7),data.track]),options.lifecycle&&internals.console("log",["%c!PERF/SUSPECT: %s items    %O","background:#fcc;",pad(formatNumber(n["*"]),7),n]),options.hooks&&internals.console("log",["%c!PERF/HOOKS: %s hooks    %O","background:#fcc;",pad(formatNumber(r["*"]),7),r]),options.timers&&internals.console("log",["%c!PERF/TIMERS:  %s timers/s %O","background:#fcc;",pad(formatNumber(o.timeoutsPerSecond+o.intervalsPerSecond),7),o]),options.timeline&&internals.console("log",["%c!PERF/TIMELINE:%s events   %O","background:#cfc;",pad(formatNumber(data.times["*"]),7),data.times]),internals.console("groupEnd"),data.times={"*":0}}else internals.console("log",["%c!PERF/SNAPSHOT: %d events\n%O","background:#cfc;",t["*"],t]);snapshots.push(t),resetRoutes(e)},lastRender,init=!0,waitingTO,waiting=0,getHash=function(){return document.location.hash||"#"},hasRouteChanged=function(e){return e!==getHash()},calcSeq=function(e){var t,n,r,o,i=e.map(function(e){return{start:e.start,end:e.start+e.ms}});for(i.sort(function(e,t){return e.start-t.start});o!==i.length;)for(o=r=i.length;r--;)r&&(t=i[r])&&(n=i[r-1])&&t.start<n.end&&(n.end=Math.max(t.end,n.end),i.splice(r,1));return i.reduce(function(e,t){return e+t.end-t.start},0)},countAlwaysOn=function(){var e,t,n,r,o=arguments.length,i=[],a=this.bucket,s=getHash(),u=getDtm(),c=function(e){var t;data.perf.complete=e,data.perf.ms=Math.round((e&&lastRender?lastRender:u)-data.perf.start);for(t in data.perf.buckets)data.perf.buckets[t].ms=calcSeq(data.perf.buckets[t].details);try{methods.handler(data.perf)}catch(e){}if(options.output){var n=e?"%c!PERF/COMPLETE: %d":"%c!PERF/ABORT: %d",r=e?"background:#cfc;":"background:#ffc;";internals.console("groupCollapsed",[n,r,data.perf.ms]),internals.console("log",["%c!PERF/SUMMARY: %O","background:#cff;",data.perf]),internals.console("groupEnd")}};if(s!==lastRoute&&(lastRoute&&!data.perf.ms&&c(!waiting),data.perf={buckets:{},first:init,key:s.split(";")[0],params:s.split(";").slice(1),start:init&&!lastRoute&&u<1e9?0:u,dtm:Date.now()},lastRoute=s,lastRender=0,waiting=0),!a)return noop;for(clearTimeout(waitingTO);o--;)i[o]=""+arguments[o];return r=i.join("/"),e=getObject(data.perf.buckets,a,{msSum:0,details:[]}),n={start:Math.round(u-data.perf.start),key:r},e.details.push(n),waiting++,init=!1,function(){if(t)throw new Error('blue/perf: "done" function can only be called once');if(!hasRouteChanged(s)){var r=getDtm(),o=r-u;t=1,n.ms=Math.round(o),e.msSum+=n.ms,waiting--,"render"===a&&(lastRender=r),waiting||data.perf.ms||(waitingTO=internals.setTimeout(function(){hasRouteChanged(s)||c(!0)},500))}}},count=function(){var x,route,key,result,me=this,dtmNow=getDtm(),keys=[],keys2=[],routeName=getHash();for(routeName!==lastRoute&&(lastRoute&&options.auto&&snapshot(lastRoute),routeHistory.push(routeName),lastRoute=routeName,dtmLastRoute=dtmNow),x=arguments.length;x--;)keys[x]=keys2[x]=""+arguments[x];return key=keys.join(" "),options.lifecycle&&me.id&&track(keys[0],me.id,me.ref),options.timestamp&&internals.console("timeStamp",["[START] "+keys2.join("/")]),options.mark&&perfMark("[START] "+keys2.join("/")),route=getObject(data.routes,routeName,{"*:cnt":0,"*:ms":0}),buildTree(route,keys),route["*:cnt"]++,data.all["*:cnt"]++,options.timeline&&me.time&&(data.times["[ "+dtmCnt+++" | "+(dtmNow-dtmLastRoute)+" ] "+key]={event:key,fromStart:dtmNow-dtmStart,fromRoute:dtmNow-dtmLastRoute,idle:dtmNow-dtmLastEvent},data.times["*"]++,dtmLastEvent=dtmNow),options.debug&&test(debugRx,key,me.ref)&&eval("debugger"),options.trace&&(result=test(traceRx,key,me.ref))&&internals.console("trace",["%c!PERF/LOG: %s","background:#cfc;",key,result]),dtmNow=getDtm(),function(e){var t=getDtm()-dtmNow;if(!keys2)throw new Error('blue/perf: "done" function can only be called once');options.timestamp&&internals.console("timeStamp",["[FINISH] "+keys2.join("/")]),options.mark&&perfMark("[FINISH] "+keys2.join("/")),route["*:ms"]+=t,addTime(route,keys2,t,e>t),keys2=0}},timerUpdate=function(e,t,n){n?(e.total++,e["*"]++,e.timeline[0]++,e[t]=n):e[t]&&(e["*"]--,delete e[t])},timerInterceptor=function(){originals.setTimeout||(originals.setInterval=root.setInterval,originals.clearInterval=root.clearInterval,root.setInterval=function(e,t){var n=originals.setInterval.apply(root,arguments);return timerUpdate(originals.setIntervalIndex,n,{fn:e,interval:t}),n},root.clearInterval=function(e){timerUpdate(originals.setIntervalIndex,e),originals.clearInterval.apply(root,arguments)},originals.setTimeout=root.setTimeout,originals.clearTimeout=root.clearTimeout,root.setTimeout=function(e,t){var n=originals.setTimeout.call(root,function(){timerUpdate(originals.setTimeoutIndex,n),e()},t);return timerUpdate(originals.setTimeoutIndex,n,{fn:e,timeout:t}),n},root.clearTimeout=function(e){timerUpdate(originals.setTimeoutIndex,e),originals.clearTimeout.apply(root,arguments)})},consoleInterceptor=function(){var e;if(root.console&&!originals.console.log)for(e in root.console)"function"==typeof root.console[e]&&function(e){var t=consoleLevels[e]||0;originals.console[e]=root.console[e]||noop,root.console[e]=function(){options.enabled&&t&&options.console>t||originals.console[e].apply(root.console,arguments)}}(e)},functionInterceptor=function(){originals.func.bind||(originals.func.bind=Function.prototype.bind,Function.prototype.bind=function(){var e=methods.count("function","bind",this.toString().slice(0,100)),t=originals.func.bind.apply(this,arguments);return e(),t})},saveOptions=function(){try{localStorage.setItem("blue/perf",JSON.stringify(options))}catch(e){}},applyOptions=function(){methods.count=options.enabled?count:countAlwaysOn,options.enabled&&(options.timers&&timerInterceptor(),options.console&&consoleInterceptor(),options.bind&&functionInterceptor())},updateOptions=function(e){var t;for(t in e)options[t]=e[t];applyOptions(),saveOptions()},loadOptions=function(){try{options=JSON.parse(localStorage.getItem("blue/perf")||"{}")||{}}catch(e){options={}}applyOptions()};return methods={count:countAlwaysOn,enable:function(e){var t={enabled:!0,auto:!0,output:!0,bind:!0,hooks:!0,lifecycle:!0,mark:!0,timestamp:!0,timers:!0,debug:!0,trace:!0,console:0,timeline:!1};options=e?"object"==typeof e?e:t:{},saveOptions()},handler:noop,disable:function(){options={},saveOptions()},updateOptions:updateOptions,showUI:function(){var e,t=this,n=function(){if(!options.enabled)return void $("#blue-perf-counters").hide();var t,n,r,o,i=['<b style="color:#369;">Events:</b> <span>'+formatNumber(data.all["*:cnt"])+"</span>"];options.lifecycle&&(o=getLeaked(),i.push('<b style="color:#963;">Tracked:</b> <span>'+formatNumber(data.track["*"])+"</span>"),i.push('<b style="color:#933;">Suspect:</b> <span>'+formatNumber(o["*"])+"</span>")),options.timers&&(r=getTimers(),i.push('<b style="color:#933;">Timers / Sec:</b> <span>'+formatNumber(r.timeoutsPerSecond+r.intervalsPerSecond,2)+"</span>")),t=i.join(" | "),e!==t&&(n=$("#blue-perf-counters"),n.html(e=t),$("#blue-perf-counters").show())};void 0===ui?(!function(){var e,n,r=function(){var e;for(e in options)$("#blue-perf-option-"+e).prop("checked",options[e])},o=function(){var e,t="all";for(e in consoleLevels)if(options.console===consoleLevels[e]){t=e;break}$("#blue-perf-console-"+t).prop("checked",!0)},i=function(e){var n={},r=e.target.getAttribute("option"),i=e.target.checked;"console"===r?($("#blue-perf-options").hide(),$("#blue-perf-console").show(),o()):(n[r]=i,t.updateOptions(n))},a=function(e){var n=e.target.value;t.updateOptions({console:parseInt(n,10)}),r()},s=function(){var e=$("#blue-perf-options");e.is(":visible")?e.hide():(r(),e.show()),$("#blue-perf-console").hide()},u={SNAPSHOT:function(){t.snapshot(getHash())},RESET:function(){t.reset()},v:s},c=[],l={auto:"Auto-snapshot",output:"Output to console",mark:"Enable perf markers",timestamp:"Output to timeline",bind:"Track bind",hooks:"Track jQuery DOM Hooks",lifecycle:"Track lifecycles",timers:"Track timers",debug:"Dynamic debugging",trace:"Dynamic tracing",console:"Disable console methods",timeline:"Timeline Logging"},f=[],d=[],p="position:fixed;z-index:4294967295;background:#ccc;padding:2px 5px;border-color:#999; border-style:solid;font-size:10px;",h=['<div id="blue-perf-counters" style="'+p+'top:0;left:0;border-width:0 1px 1px 0; border-bottom-right-radius:5px;"></div>','<div id="blue-perf-tools" style="'+p+'top:0;right:0;border-width:0 0 1px 1px;border-bottom-left-radius:5px;">','<input type="checkbox" id="blue-perf-option-enabled" option="enabled"/>','<label for="blue-perf-option-enabled">&nbsp;PERF TOOLS</label>&nbsp;#buttonHTML#',"</div>",'<div id="blue-perf-options" style="'+p+'top:28px;right:5px;border-width:0 0 1px 1px;border-radius:5px;display:none;">#checkHTML#</div>','<div id="blue-perf-console" style="'+p+'top:28px;right:5px;border-width:0 0 1px 1px;border-radius:5px;display:none;"><span>Allow Console Level</span><hr/>#consoleHTML#</div>'];for(e in u)c.push('<button id="blue-perf-button-'+e+'">'+e+"</button>");for(e in l)f.push((n>e?"<hr/>":"")+'<input type="checkbox" id="blue-perf-option-'+e+'" option="'+e+'"/><label for="blue-perf-option-'+e+'">&nbsp;'+l[e]+"</label>"),n=e;for(e in consoleLevels)d.push('<input type="radio" id="blue-perf-console-'+e+'" name="blue-perf-console" value="'+consoleLevels[e]+'"/><label for="blue-perf-console-'+e+'">&nbsp;'+e+"</label>");f.push('<span style="float:right;">v'+v+"</span>"),$(document.body).append(h.join("").replace(/#buttonHTML#/,c.join("&nbsp;")).replace(/#checkHTML#/,f.join("<br/>")).replace(/#consoleHTML#/,d.join("<br/>"))),$("#blue-perf-option-enabled").on("change",i),$("#blue-perf-console input[name=blue-perf-console]:radio").on("change",a),$("#blue-perf-console input[name=blue-perf-console]:radio").on("click",s);for(e in u)$("#blue-perf-button-"+e).on("click",u[e]);for(e in l)$("#blue-perf-option-"+e).on("change",i);r()}(),ui=internals.setInterval.call(root,n,500)):(clearInterval(ui),ui=void 0,function(){$("#blue-perf-counters").remove(),$("#blue-perf-tools").remove(),$("#blue-perf-options").remove()}())},resetRoutes:resetRoutes,reset:function(){data={times:{"*":0},routes:{},all:{"*:cnt":0,"*:ms":0},complete:{},track:{"*":0},perf:{}},originals.setTimeoutIndex={"*":0,total:0,timeline:[0]},originals.setIntervalIndex={"*":0,total:0,timeline:[0]},lastRoute="",snapshots=[],debugRx=[],traceRx=[]},snapshot:snapshot,getRoutes:getRoutes,getLeaked:getLeaked,getHooks:getHooks,getSnapshots:function(){return snapshots},getCount:function(e,t){return(e?data.routes[e]||{"*":0}:data.all)[t||"*"]||0},getTimers:getTimers,debug:function(e){e?debugRx.push(e):internals.console("log",["Example usage:\n\tdebug(/regexp/)\n\tdebug(function (key, ref) { return ref && ref.prop === 'val'; })"])},trace:function(e){e?traceRx.push(e):internals.console("log",["Example usage:\n\ttrace(/regexp/)\n\ttrace(function (key, ref) { return ref && ref.prop === 'val'; })"])}},methods.reset(),loadOptions(),methods}),define("blue/model",["require","./as/serializable","blue/perf"],function(e){"use strict";var t,n=e("./as/serializable"),r=e("blue/perf"),o=0,i=Object.prototype.hasOwnProperty,a=function(e){return Object.keys(e).length},s=function(e){var t=!this.data.models||!this.data.models[this.id];if(t&&e)throw new Error('"'+e.slice(1)+'" cannot be call on a destroyed model');return t},u=function(e,t){return Object.keys(t).forEach(function(n){e[n]=t[n]}),e},c=function(e,t){if(e===t&&null!==e&&"object"==typeof e)return!1;if(e===t)return!0;if(e==t||!e||!t||"object"!=typeof e||"object"!=typeof t)return!1;var n,r=0,o=0;for(n in e)if(i.call(e,n)&&++r&&(!i.call(t,n)||!c(e[n],t[n])))return!1;for(n in t)i.call(t,n)&&o++;return!!(r+o)&&r===o},l=function(e){if(null===e||"object"!=typeof e||e.prototype)return e;var t,n;switch(e.constructor){case Array:for(t=[],n=e.length;n--;)t[n]=l(e[n]);return t;case Date:return new Date(+e);case RegExp:return new RegExp(e.source,(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":""));default:t={};for(n in e)i.call(e,n)&&(t[n]=l(e[n]));return t}},f=function(e,t,n){for(var r;void 0!==(r=t.shift());){if(n&&void 0!==e[r]&&"object"!=typeof e[r])throw new Error("cannot add property to non-object");e=n?e[r]||(e[r]={}):e&&i.call(e,r)?e[r]:void 0}return e},d=function(e,t,n){for(var r,o=e.tree;void 0!==(r=t.shift());)o.props[r]||(o.props[r]={cnt:0,any:0,handlers:{},props:{}}),o=o.props[r],o.any+=n;return o},p=function(e,t,n,r){for(var o,i=e.split("."),a=this.data.tree,s=[],u=function(e,t){Object.keys(e.handlers).forEach(function(n){(t||e.handlers[n])&&s.push(n)})},l=function(e,t,n){var r,o;Object.keys(e.props).forEach(function(i){var a=f(t,[i]),s=f(n,[i]);r=e.props[i],o=r.cnt&&!c(a,s),(o||r.any)&&u(r,o),(o||r.any||!r.cnt)&&l(r,a,s)})};void 0!==(o=i.shift())&&a.props[o];)a=a.props[o],u(a,r);return void 0===o&&l(a,t,n),s},h=function(e){var t=this.data,n=t.handlers;if(n&&n[e]){var r,o=n[e],i=o.path,s=i.split("."),u=d(t,s,o.options.skipRepeats?0:-1),c=function(e){var n=e.split("."),r=n.pop(),o=n.join("."),i=d(t,n,0),s=i.props;r&&(s[r].cnt||a(s[r].props)||(delete s[r],c(o)))};for(delete u.handlers[e],u.cnt--,delete t.models[o.parent].on.value[e];r=t.handlers[e].options.tos.pop();)clearTimeout(r);delete t.handlers[e],u.cnt||c(i)}},m=function(e,t){for(var n,r,o,i,a;e.length;)o=this.data.handlers[e.pop()],i=o.options,o.path!==n&&(n=o.path,r=t.substr(n.length+1),a=f(this.data,n.split(".")),this.methods.isolate&&(a=l(a))),o.handler.call(i.scope,i.isolate?l(a):a,r)},g=function(e){var t=this.id,n=this.data,r="n"+o++,i=function(){delete n.models[t].on.destroy[r],e()};return n.models[t].on.destroy[r]=i,i},b=function(e,t){console.groupCollapsed&&console.groupCollapsed("Model Internals"),console.log("id:",e.id),console.log("path:",e.lensPath),t&&console.log("data:",e.data),console.log("methods:",e.methods),console.log("on:",e.on),console.log("children:",e.children),console.groupEnd&&console.groupEnd()},v=function(e,t){var n=this.methods,r=e.split("."),o=f(this.data,r),i=t&&"isolate"in t?t.isolate:n.isolate;return n.get?n.get(o,e.substr(this.lensPath.length+1)):i?l(o):o},y=function(e,t,n){var r,o=this.methods,i=e.split("."),a=i.pop(),s=f(this.data,i,1),u=o.set?o.set(s[a],t,e.substr(this.lensPath.length+1)):t,d=this._changed||!c(s[a],u),h=n&&"isolate"in n?n.isolate:o.isolate;return d&&h&&(u=l(u)),r=p.call(this,e,s[a],u,d),d&&(s[a]=u),m.call(this,r,e),d},x=function(e,t,n){var r;return Object.keys(t||{}).forEach(function(o){r|=y.call(this,e+"."+o,t[o],n)},this),1===r},w=function(e,n){r.count.call({id:"<modelLens:n"+o+">",ref:this.data},"blue/model","create/lens",e);var i=this.data,a="n"+o,s=new t(i,e,n);return i.models[a].parent=this.id,i.models[this.id].children[a]=1,s},E=function(e,t){this._changed=!0;var n=v.call(this,e),r=t(n),o=y.call(this,e,r);return this._changed=!1,o},k=function(e){var t=this.data.handlers;return Object.keys(t).some(function(n){var r=t[n].path;return e===r||e+"."===r.substr(0,e.length+1)||r+"."===e.substr(0,r.length+1)})},j=function(e,t,n,r){for(var o,i,a=["addEventListener","addListener","on"],s=["removeEventListener","removeListener","off"],u=y.bind(this,e),c=r||function(e){return e},l=function(e){u(c(e))};(o=a.shift())&&(i=s.shift())&&("function"!=typeof t[o]||"function"!=typeof t[i]););if(!o)throw new Error("source must support addEventListener, addListener, or on");return t[o](n,l),g.call(this,t[i].bind(t,n,l))},S=function(e,t){var n,r=function(){},o=y.bind(this,e),i=t.onValue?t.onValue(o):t.subscribe?t.subscribe(o,r,r):t.observe?t.takeWhile(function(){return!n}).observe(o)&&function(){n=1}:r,a="function"==typeof i?i:t.offValue?t.offValue.bind(t,o):i.dispose?i.dispose.bind(i):r;return g.call(this,a)},O=function(e,t,n,r){var o=this,i=o.data,a=e.split("."),s=d(i,a,r.skipRepeats?0:1),u=function(e,t,n){t.tos.push(setTimeout(function(){t.tos.shift(),e.call(t.scope,n)},t.delay))},c=function(e,t,n,r,i){if(t.tos.length)return t.x=1;(t.leading||i)&&e.call(t.scope,r),t.x=!i&&!t.leading,t.tos.push(setTimeout(function(){t.tos.shift(),t.x&&t.trailing&&c(e,t,n,v.call(o,n),1)},t.throttle))},l=function(e,t,n,r){!t.tos.length&&t.immediate&&e(r),clearTimeout(t.tos.shift()),t.tos.push(setTimeout(function(){t.tos.shift(),!t.immediate&&e.call(t.scope,v.call(o,n))},t.debounce))};s.cnt++,s.handlers[t]=r.skipRepeats?0:1,i.models[o.id].on.value[t]=1,r.tos=[],r.delay?n=u.bind(o,n,r):r.debounce?n=l.bind(o,n,r,e):r.throttle&&(n=c.bind(o,n,r,e)),i.handlers[t]={path:e,parent:o.id,handler:n,options:r}},P=function(e,t,n){var r=this,i="n"+o++;return n=u({initial:1,leading:1,trailing:1,skipRepeats:1},n||{}),O.call(this,e,i,t,n),n.initial&&t.call(n.scope,v.call(this,e),""),function(){h.call(r,i)}},T=function(e,t,n){var r=this;if(!s.call(r,"_connect")){var o,i={},a=e===t,u=r.lensPath,c=[],l=function(){for(var e;e=c.pop();)e()},f=function(e,t){var n=e+".",r=t+".";if(n===r||n===r.slice(0,n.length)||r===n.slice(0,r.length))throw new Error("cannot connect same/nested properties on the same model")};for(o in n)!function(e){a&&f(e,o);var n=o?u+"."+o:u,s=function(n){if(!i[e]){if(t.destroyed)return l();i[e]=!0,e?t.set(e,n):t.set(n),i[e]=!1}},d=function(t){i[e]||(i[e]=!0,y.call(r,n,t),i[e]=!1)};c.push(P.call(r,n,s,{isolate:!0})),g.call(r,e?t.onValue(e,d,{isolate:!0,initial:!1}):t.onValue(d,{isolate:!0,initial:!1}))}(n[o])}},I=function(e,t){var n,r=this,o=function(t,o){return n||(g.call(r,o),n=1),P.call(r,e,t,{initial:!1})};return t.stream?t.stream(function(e){return o(e.emit,e.end)}):t.fromBinder?t.fromBinder(function(e){return o(e,function(){e(new t.End)})}):t.Observable&&t.Observable.create?t.Observable.create(function(e){return o(e.onNext.bind(e),e.onCompleted.bind(e))}):t.create?t.create(function(e,t){return o(e,t)}):void 0},R=function(e){var t,n,o,i=this;s.call(i)||(void 0!==i.parent?r.count.call({id:"<modelLens:"+i.id+">"},"blue/model","destroy/lens",i.lensPath):r.count.call({id:"<model:"+i.id+">"},"blue/model","destroy",i.lensPath),t=i.data,n=t.models[i.id],o=i.instance,Object.keys(n.children).forEach(function(e){R.call(t.models[e])}),Object.keys(n.on.destroy).forEach(function(e){n.on.destroy[e]()}),Object.keys(n.on.value).forEach(function(e){h.call(i,e)}),"parent"in n&&delete t.models[n.parent].children[i.id],delete t.models[i.id],delete i.instance,e&&(e.logger&&k.call(i,i.lensPath)&&e.logger.warn("Destroyed model data that had listeners"),y.call(i,i.lensPath,void 0)),a(t.models)||(delete t.handlers,delete t.models,delete t.root,delete t.tree),o.destroyed=!0)},C=function(e,t,n,r){var o=this.me,i=this.func;if(!s.call(o,i.name||"_method")){var a;return a=arguments.length<this.expect||"string"!=typeof e||"function"==typeof e?[o.lensPath,e,t,n,r]:["string"==typeof e?[o.lensPath,e].join("."):o.lensPath,t,n,r],i.apply(o,a)}};return t=function(e,t,n){var r={id:"n"+o++,data:e,lensPath:t,instance:this,methods:n||{},on:{value:{},destroy:{}},children:{}};e.models[r.id]=r,this.logInternals=function(){return b(r)},this.get=function(){return C.apply({me:r,expect:1,func:v},arguments)},this.set=function(){return C.apply({me:r,expect:2,func:y},arguments)},this.lens=function(e){var t=C.apply({me:r,expect:1,func:w},arguments);return t.lensPath=e,t},this.modify=function(){return C.apply({me:r,expect:2,func:E},arguments)},this.fromEvent=function(){return C.apply({me:r,expect:3,func:j},arguments)},this.fromStream=function(){return C.apply({me:r,expect:2,func:S},arguments)},this.onValue=function(){return C.apply({me:r,expect:2,func:P},arguments)},this.connect=function(e,t){return T.call(r,this,e,t)},this.toStream=function(){return C.apply({me:r,expect:2,func:I},arguments)},this.logInternals=function(e){return b(r,e)},this.get=function(){return C.apply({me:r,expect:1,func:v},arguments)},this.set=function(){return C.apply({me:r,expect:2,func:y},arguments)},this.update=function(){return C.apply({me:r,expect:2,func:x},arguments)},this.lens=function(e){var t=C.apply({me:r,expect:1,func:w},arguments);return t.lensPath=e,t},this.modify=function(){return C.apply({me:r,expect:2,func:E},arguments)},this.fromEvent=function(){return C.apply({me:r,expect:3,func:j},arguments)},this.fromStream=function(){return C.apply({me:r,expect:2,func:S},arguments)},this.onValue=function(){return C.apply({me:r,expect:2,func:P},arguments)},this.connect=function(e,t){return T.call(r,this,e,t)},this.toStream=function(){return C.apply({me:r,expect:2,func:I},arguments)},this.destroy=function(e){return R.call(r,e)}},n.call(t.prototype,function(e){return{model:e?function(e,t){if(!e)return{};var n,r=l(t);for(n in r)!(e[n]||{}).exportable&&delete r[n];return r}(e,this.get()):this.get()}}),function(e,n){var i={handlers:{},models:{},root:(n||{}).isolate?l(e):e,tree:{props:{}}};return r.count.call({id:"<model:n"+o+">",ref:i},"blue/model","create","root"),new t(i,"root",n)}}),define("blue/has",["require","./root"],function(e){"use strict";function t(e,t){this.root=e,t&&this.addAll(t)}function n(e){return e?r[e]:r}var r,o=e("./root");return t.prototype={add:function(){for(var e,t=[];"string"==typeof(e=Array.prototype.shift.call(arguments));)t.push(e);e="function"==typeof e?e(this.root):e;for(var n=0,r=t.length;n<r;n++)this[t[n]]=e},addAll:function(e){if("object"==typeof(e="function"==typeof e?e(this.root):e)&&e.constructor===Object)for(var t in e)e.hasOwnProperty(t)&&this.add(t,e[t])}},t.constructor=t.prototype.constructor=t,r=new t(o),n().add("has-api",!0),n}),define("blue/has/walk",["require","../has","mout/object/hasOwn"],function(e){"use strict";var t=e("../has"),n=e("mout/object/hasOwn"),r=function(e,t){return typeof e===t},o=function(e,t){return t?(""===e?t:e+"-"+t).toLowerCase():t};return function e(i,a,s){var u;for(var c in i)if(n(i,c)&&!r(a,"undefined")&&(u=i[c],r(u,"object")))if("prototype"===c)e(u,a[c],s);else{var l;try{l=a[c]}catch(e){l=void 0}var f=o(s,c),d=o(s,u.$alias);t().add(f,c in a),d&&t().add(d,c in a),Object.keys(u).length>0&&(e(u,l,c),d&&e(u,l,d))}}}),define("blue/has/var/env",{addEventListener:{},ArrayBuffer:{},clearTimeout:{},clearImmediate:{},clearInterval:{},crypto:{getRandomValues:{}},DataView:{},decodeURI:{},decodeURIComponent:{},dispatchEvent:{},document:{$alias:"dom",addEventListener:{},attachEvent:{},cookie:{},detachEvent:{},dispatchEvent:{},removeEventListener:{}},Element:{prototype:{addEventListener:{},attachEvent:{},detachEvent:{},dispatchEvent:{},removeEventListener:{}}},encodeURI:{},encodeURIComponent:{},Event:{},Float32Array:{},Float64Array:{},getComputedStyle:{},history:{pushState:{},replaceState:{}},indexedDB:{},Int8Array:{},Int16Array:{},Int32Array:{},isFinite:{},isNaN:{},localStorage:{},matchMedia:{},MessageChannel:{},module:{exports:{}},MutationObserver:{prototype:{}},navigator:{cookieEnabled:{},language:{},languages:{},plugins:{},geolocation:{},userAgent:{},userLanguage:{}},parseFloat:{},parseInt:{},postMessage:{},process:{nextTick:{},versions:{node:{},v8:{}}},Promise:{all:{},reject:{},resolve:{},prototype:{catch:{},then:{}}},removeEventListener:{},screen:{},sessionStorage:{},setTimeout:{},setImmediate:{},setInterval:{},showModalDialog:{},XMLHttpRequest:{$alias:"xhr",prototype:{open:{}}},Array:{from:{},isArray:{},observe:{},of:{},unobserve:{},prototype:{concat:{},copyWithin:{},entries:{},every:{},fill:{},filter:{},find:{},findIndex:{},forEach:{},indexOf:{},join:{},keys:{},lastIndexOf:{},map:{},pop:{},push:{},reduce:{},reduceRight:{},reverse:{},shift:{},slice:{},sort:{},some:{},splice:{},toString:{},unshift:{},values:{}}},console:{assert:{},clear:{},count:{},debug:{},dir:{},dirxml:{},error:{},group:{},groupCollapsed:{},groupEnd:{},info:{},log:{},markTimeline:{},memoryProfile:{},memoryProfileEnd:{},profile:{},profileEnd:{},table:{},time:{},timeEnd:{},timeStamp:{},trace:{},warn:{}},Date:{now:{},parse:{},UTC:{},prototype:{getDate:{},getDay:{},getFullYear:{},getHours:{},getMilliseconds:{},getMinutes:{},getMonth:{},getSeconds:{},getTime:{},getTimezoneOffset:{},getUTCDate:{},getUTCDay:{},getUTCFullYear:{},getUTCHours:{},getUTCMilliseconds:{},getUTCMinutes:{},getUTCMonth:{},getUTCSeconds:{},setDate:{},setFullYear:{},setHours:{},setMilliseconds:{},setMinutes:{},setMonth:{},setSeconds:{},setTime:{},setUTCDate:{},setUTCFullYear:{},setUTCHours:{},setUTCMilliseconds:{},setUTCMinutes:{},setUTCMonth:{},setUTCSeconds:{},toDateString:{},toISOString:{},toJSON:{},toLocaleDateString:{},toLocaleFormat:{},toLocaleString:{},toLocaleTimeString:{},toString:{},toTimeString:{},toUTCString:{},valueOf:{}}},Function:{prototype:{apply:{},bind:{},call:{},isGenerator:{},name:{},toMethod:{},toString:{}}},JSON:{parse:{},stringify:{}},Map:{prototype:{clear:{},delete:{},entries:{},forEach:{},get:{},has:{},keys:{},set:{},values:{}}},Math:{abs:{},acos:{},acosh:{},asin:{},asinh:{},atan:{},atan2:{},atanh:{},cbrt:{},ceil:{},clz32:{},cos:{},cosh:{},exp:{},expm1:{},floor:{},fround:{},hypot:{},imul:{},log:{},log1p:{},log2:{},log10:{},max:{},min:{},pow:{},random:{},round:{},sign:{},sin:{},sinh:{},sqrt:{},tan:{},tanh:{},trunc:{}},media:{matchMedium:{}},Number:{isFinite:{},isInteger:{},isNaN:{},isSafeInteger:{},toInteger:{},prototype:{clz:{},toExponential:{},toFixed:{},toLocaleString:{},toPrecision:{},toString:{},valueOf:{}}},Object:{assign:{},create:{},defineProperty:{},defineProperties:{},deliverChangeRecords:{},freeze:{},getNotifier:{},getOwnPropertyDescriptor:{},getOwnPropertyDescriptors:{},getOwnPropertyNames:{},getOwnPropertySymbols:{},getPropertyDescriptor:{},getPropertyNames:{},getPrototypeOf:{},is:{},isExtensible:{},isFrozen:{},isSealed:{},keys:{},mixin:{},observe:{},preventExtensions:{},seal:{},setPrototypeOf:{},unobserve:{},prototype:{eval:{},hasOwnProperty:{},isPrototypeOf:{},propertyIsEnumerable:{},toLocaleString:{},toString:{},unwatch:{},valueOf:{},watch:{}}},performance:{navigation:{toJSON:{}},now:{},timing:{toJSON:{}},toJSON:{}},RegExp:{prototype:{compile:{},exec:{},match:{},replace:{},search:{},split:{},test:{},toString:{}}},Set:{prototype:{add:{},clear:{},delete:{},entries:{},forEach:{},has:{},values:{}}},String:{fromCharCode:{},fromCodePoint:{},raw:{},prototype:{anchor:{},big:{},blink:{},bold:{},charAt:{},charCodeAt:{},codePointAt:{},concat:{},contains:{},createHTML:{},endsWith:{},fixed:{},fontcolor:{},fontsize:{},indexOf:{},italics:{},lastIndexOf:{},link:{},localeCompare:{},match:{},normalize:{},quote:{},repeat:{},replace:{},search:{},slice:{},small:{},split:{},startsWith:{},strike:{},sub:{},substr:{},substring:{},sup:{},toArray:{},toLocaleLowerCase:{},toLocaleUpperCase:{},toLowerCase:{},toString:{},toUpperCase:{},trim:{},trimLeft:{},trimRight:{},valueOf:{}}},styleMedia:{matchMedium:{}},Uint8Array:{},Unit8ArrayClamped:{},Unit16Array:{},Uint32Array:{},WeakMap:{prototype:{clear:{},delete:{},get:{},has:{},set:{}}},WeakSet:{prototype:{add:{},clear:{},delete:{},has:{}}}}),define("blue/has/detect",["require","../has","./walk","./var/env","../root"],function(e){"use strict";var t=e("../has");return e("./walk")(e("./var/env"),e("../root"),""),t}),define("blue/has/framed",["require","../has"],function(e){"use strict";var t=e("../has")
;return t().add("framed",function(e){return e.self!==e.top}),t}),define("blue/dom",["require","./has/detect","./root"],function(e){"use strict";var t=e("./has/detect"),n=e("./root");return t("dom")?n.document:{}}),define("blue/dom/createElement",["require","../dom"],function(e){"use strict";var t=e("../dom");return function(){return t.createElement.apply(t,arguments)}}),define("blue/has/iframe",["require","./detect","../dom/createElement"],function(e){"use strict";var t=e("./detect"),n=e("../dom/createElement"),r=n("iframe");return t().add("iframe-sandbox",function(){return"sandbox"in r}),t().add("iframe-seamless",function(){return"seamless"in r}),t().add("iframe-srcdoc",function(){return"srcdoc"in r}),r=void 0,t}),define("blue/has/var/INPUT_TYPES",[],function(){"use strict";return"search tel url email datetime date month week time datetime-local number range color".split(" ")}),define("blue/dom/body",["require","../dom"],function(e){"use strict";var t=e("../dom");return t.documentElement||t.body}),define("blue/has/form",["require","./detect","./var/INPUT_TYPES","../dom","../dom/body","../dom/createElement"],function(e){"use strict";for(var t,n,r=e("./detect"),o=e("./var/INPUT_TYPES"),i=e("../dom"),a=e("../dom/body"),s=e("../dom/createElement"),u=i,c=a,l=s("input"),f=s("textarea"),d=/^range$/,p=/^(search|tel)$/,h=/^(url|email)$/,m=!1,g=0,b=o.length;g<b;g++)l.setAttribute("type",n=o[g]),m="text"!==l.type,m&&(l.value="__TEST__",l.style.cssText="position:absolute;visibility:hidden;",d.test(n)&&void 0!==l.style.WebkitAppearance?(c.appendChild(l),t=u.defaultView,m="textfield"!==t.getComputedStyle(l,null).WebkitAppearance&&0!==l.offsetHeight,c.removeChild(l)):p.test(n)||(m=h.test(n)?l.checkValidity&&!1===l.checkValidity():"__TEST__"!==l.value)),r().add("input-"+n,!!m);return r().add("input-placeholder","placeholder"in l),r().add("textarea-placeholder","placeholder"in f),l=f=void 0,r}),define("blue/has/object",["require","./detect","../dom/createElement"],function(e){"use strict";var t=e("./detect"),n=e("../dom/createElement"),r=n("div"),o=function(e){var t=!1;try{Object.defineProperty(e,"definedProperty1",{value:1}),t="definedProperty1"in e}catch(e){}return t},i=function(e){var t=!1;try{Object.defineProperties(e,{definedProperty2:{value:1}}),t="definedProperty2"in e}catch(e){}return t},a=function(e){var t=!1;e.definedProperty3=!0;try{t=Object.getOwnPropertyDescriptor(e,"definedProperty3").value}catch(e){}return t};return t().add("object-__proto__","array-__proto__",function(){var e={__proto__:[]}instanceof Array;if(e){var t=[],n=t.__proto__;t.__proto__={},e=void 0===t.push,t.__proto__=n,e="function"==typeof t.push}return e}),t().add("object-defineproperties-obj",t("object-defineproperties")&&i({})),t().add("object-defineproperties-dom",t("object-defineproperties")&&!0&&i(r)),t().add("object-defineproperty-obj",t("object-defineproperty")&&o({})),t().add("object-defineproperty-dom",t("object-defineproperty")&&!0&&o(r)),t().add("object-getownpropertydescriptor-obj",t("object-getownpropertydescriptor")&&a({})),t().add("object-getownpropertydescriptor-dom",t("object-getownpropertydescriptor")&&!0&&a(r)),r=void 0,t}),define("blue/has/style",["require","./detect","../dom/createElement"],function(e){"use strict";var t=e("./detect"),n=e("../dom/createElement"),r=n("style");return t().add("style-currentstyle","currentStyle"in r),t().add("style-stylesheet","styleSheet"in r),t().add("style-textcontent","textContent"in r),t}),define("blue/has/storage",["require","./detect","blue/root"],function(e){"use strict";var t=e("./detect"),n=e("blue/root"),r=t("localstorage"),o=t("sessionstorage"),i=t("navigator-cookieenabled");return r&&t().add("localstorage",function(){var e=!0;try{localStorage.setItem("has","has"),"has"!==localStorage.getItem("has")?e=!1:localStorage.removeItem("has","has")}catch(t){e=!1}return e}),o&&t().add("sessionstorage",function(){var e=!0;try{sessionStorage.setItem("has","has"),"has"!==sessionStorage.getItem("has")?e=!1:sessionStorage.removeItem("has","has")}catch(t){e=!1}return e}),i&&t().add("navigator-cookieenabled",n.navigator.cookieEnabled),t}),define("blue/has/all",["require","./detect","blue/has/framed","blue/has/iframe","blue/has/form","blue/has/object","blue/has/style","blue/has/storage"],function(e){"use strict";var t=e("./detect");return e("blue/has/framed"),e("blue/has/iframe"),e("blue/has/form"),e("blue/has/object"),e("blue/has/style"),e("blue/has/storage"),t}),define("blue/device/platform",["require","../has/all","platform"],function(e){"use strict";return e("../has/all")("navigator-useragent")?e("platform"):{}}),define("blue/is",["require","./root","mout/object/hasOwn","mout/lang/kindOf","./device/platform"],function(e){"use strict";var t=e("./root"),n=e("mout/object/hasOwn"),r=e("mout/lang/kindOf"),o=e("./device/platform"),i={Boolean:!0,Number:!0,String:!0,Undefined:!0},a=/<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>/,s=function(e){return"string"==typeof e||e instanceof String},u=function(e,t){var n=r(e);return s(t)&&(n=n===e),n};return u.array=function(e){return"isArray"in Array?Array.isArray(e):u(e,"Array")},u.boolean=function(e){return e===!!e||e instanceof Boolean},u.date=function(e){return e instanceof Date||u(e,"Date")},u.defined=function(e){return!u.undefined(e)},u.empty=function(e){var t=!1;if(null===e)t=!1;else if(u.string(e)||u.array(e))t=!e.length;else if(u.object(e)||u.function(e)){var r=!0;for(var o in e)if(n(e,o)){r=!1;break}t=r}return t},u.finite=function(e){return"isFinite"in Number?Number.isFinite(e):"number"==typeof e||e instanceof Number||t.isFinite(e)},u.function=function(e){return"function"==typeof e||e instanceof Function},u.host=function(e){var t=u(e);return"Object"===t?!!e:!i[t]},u.integer=function(e){return u.number(e)&&e%1==0},u.markup=function(e){return u.string(e)&&a.test(e)},u.nan=function(e){return"isNaN"in Number?Number.isNaN(e):t.isNaN(parseFloat(e))},u.null=function(e){return null===e},u.number=function(e){return("number"==typeof e||e instanceof Number)&&u.finite(e)},u.numeric=function(e){return!u.nan(e)&&u.finite(e)},u.object=function(e){return!u.null(e)&&"object"==typeof e},u.plainObject=function(e){return u.object(e)&&(e.constructor===Object||u.undefined(e.constructor))},u.primitive=function(e){return u.null(e)||u.undefined(e)||u.boolean(e)||u.number(e)||u.string(e)},u.promise=function(e){return e instanceof Promise||u(e,"Promise")},u.regExp=function(e){return e instanceof RegExp||!!(u.function(e.test)&&u.function(e.exec)&&u.boolean(e.ignoreCase))},u.singleSpaced=function(e){var t=!0;return e.split(" ").forEach(function(e){""===e&&(t=!1)}),t},u.string=s,u.thenable=function(e){return u.promise(e)||u.defined(e)&&u.function(e.then)},u.undefined=function(e){return void 0===e},u.element=function(e){return u.object(HTMLElement)?e instanceof HTMLElement:e&&u.object(e)&&1===e.nodeType&&u.string(e.nodeName)},u.node=function(e){return u.object(Node)?e instanceof Node:e&&u.object(e)&&u.number(e.nodeType)&&u.string(e.nodeName)},u.internetExplorer=function(e){return"IE"===o.name&&(!e||parseInt(e,10)<=o.version)},u.magicModeSupported=function(){return u.internetExplorer(11)},u}),define("blue/log/var/loggers",{}),define("blue/log/var/levels",{ALL:Number.MIN_VALUE,TRACE:1e4,DEBUG:2e4,INFO:3e4,WARN:4e4,ERROR:5e4,FATAL:6e4,OFF:Number.MAX_VALUE}),define("blue/declare",["require","./is","mout/object/hasOwn"],function(e){"use strict";var t=e("./is"),n=e("mout/object/hasOwn");return function(e,r){t.undefined(r)&&(r=e,e=function(){},e.prototype=Object.create(null));var o=e.prototype,i=(t.function(r)?r.call(e,e,o):r)||Object.create(null),a=n(i,"constructor")?i.constructor:function(){e.apply(this,arguments)},s=Object.keys(i);a.prototype=Object.create(o);for(var u=s.length;u--;)a.prototype[s[u]]=i[s[u]];return a.constructor=a.prototype.constructor=a,a}}),define("blue/log/level",["require","blue/log/var/levels","mout/string/sentenceCase","blue/declare"],function(e){"use strict";var t=e("blue/log/var/levels"),n=e("mout/string/sentenceCase"),r=e("blue/declare"),o=r({constructor:function(e,t){this.level=e,this.name=t,this.sentenceCaseName=n(t),this.lowerCaseName=t.toLowerCase()},equals:function(e){return e instanceof o&&this.level===e.level},greaterThan:function(e){return e instanceof o&&this.level>e.level},lessThan:function(e){return e instanceof o&&this.level<e.level},toString:function(){return this.name},valueOf:function(){return this.toString()}});return Object.keys(t).forEach(function(e){o[e]=new o(t[e],e)}),o.levels=t,o}),define("blue/log/var/types",[],function(){"use strict";return"ASSERT GROUP GROUP_END LOG TIME TIME_END".split(" ")}),define("blue/string/toComponentName",[],function(){"use strict";return function(e){function t(e,t){var n=e.split(t);if(n.length>1){var r=0;e=n.map(function(e){return e=String(e).toLowerCase(),r++,r>1?e.charAt(0).toUpperCase()+e.slice(1):e}).join("")}return e}e=void 0===e||null===e?"":String(e);var n=["_","-"," "];if(!0!==/^[A-Z]*$/.test(e)){var r;n.forEach(function(n){r=r?t(r,n):t(e,n)}),e=r}return e}}),define("blue/log/type",["require","blue/log/var/types","blue/string/toComponentName","blue/declare"],function(e){"use strict";var t=e("blue/log/var/types"),n=e("blue/string/toComponentName"),r=e("blue/declare"),o=r({constructor:function(e){this.name=e,this.lowerCaseName=e.toLowerCase(),this.camelCaseName=n(this.lowerCaseName)},toString:function(){return this.name},valueOf:function(){return this.toString()}});return t.forEach(function(e){o[e]=new o(e)}),o.types=t,o}),define("blue/timer",["require","./declare"],function(e){"use strict";return e("./declare")({constructor:function(){this.startTime=0,this.stopTime=0},start:function(e){this.stopTime=0,this.startTime=e||Date.now()},stop:function(){this.stopTime=Date.now(),0===this.startTime&&(this.stopTime=0)},microseconds:function(){return 1e3*this.milliseconds()},milliseconds:function(){var e=this.stopTime;return 0===e&&0!==this.startTime&&(e=Date.now()),Math.ceil(e-this.startTime)},profile:function(e,t){for(this.start();t--;)e();this.stop()},seconds:function(){return this.milliseconds()/1e3},toString:function(){return"Timer"}})}),define("blue/log/logger",["require","../has/all","../is","../log/level","../log/type","mout/array/slice","../timer","blue/dom","blue/declare","blue/log/logger"],function(e){"use strict";var t,n=(e("../has/all"),e("../is")),r=e("../log/level"),o=e("../log/type"),i=e("mout/array/slice"),a=e("../timer"),s=e("blue/dom"),u=e("blue/declare"),c={constructor:function(t,o,i){if(!(this instanceof e("blue/log/logger")))throw new TypeError('Logger must be called with "new"');if(!n.string(t))throw new TypeError('"name" must be a string');this.name=t,this.enabled=void 0===i||i,this.appenders=new Set,this.threshold=r[o]||r.DEBUG,this.timers={}},addAppender:function(){for(var e=0,t=arguments.length;e<t;e++)this.appenders.has(arguments[e])||this.appenders.add(arguments[e])},assert:function(e){this.enabled&&!0!==e&&this.log(r.ERROR,{expression:e,message:arguments.length>1?i(arguments,1):["Assertion Failure"],type:o.ASSERT})},callAppenders:function(e){this.appenders.forEach(function(t){t&&t.append(e)})},destroy:function(){this.appenders.forEach(function(e){e&&e.destroy()}),this.name=this.enabled=this.appenders=this.threshold=this.timers=void 0},group:function(e,t){this.enabled&&this.log(r.INFO,{groupName:e,expanded:void 0===t||t,type:o.GROUP})},groupEnd:function(){this.enabled&&this.log(r.INFO,{type:o.GROUP_END})},isLevelEnabled:function(e){return this.threshold.lessThan(e)||this.threshold.equals(e)},log:function(e,t){if(this.enabled&&t&&this.isLevelEnabled(e)){var n;try{var r=s,o=r.location;n=r&&r.URL||o&&o.href||""}catch(e){n=""}t.level=e,t.loggerName=this.name,t.source=n,t.timestamp=Date.now(),this.callAppenders(t)}},removeAppender:function(e){this.appenders.has(e)&&this.appenders.delete(e)},time:function(e,t){this.enabled&&e&&(t=t||r.INFO,this.timers[e]=new a,this.timers[e].level=t,this.timers[e].start(),this.log(t,{timerName:e,type:o.TIME}))},timeEnd:function(e){var t=this.timers[e];this.enabled&&e&&t&&(t.stop(),this.log(t.level,{timerName:e,elapsed:t.milliseconds(),type:o.TIME_END}),t=this.timers[e]=void 0)},toString:function(){return" Logger[ name:"+this.name+" threshold: "+this.threshold+"]"}};return Object.keys(r.levels).forEach(function(e){t=r[e],r.ALL.equals(t)||r.OFF.equals(t)||(c["is"+t.sentenceCaseName+"Enabled"]=function(){return this.isLevelEnabled(r[e])},c[t.lowerCaseName]=function(){var n,i;if(this.enabled&&this.isLevelEnabled(t)){for(n=new Array(arguments.length),i=0;i<n.length;++i)n[i]=arguments[i];this.log(r[e],{message:n,type:o.LOG})}})}),u(c)}),define("blue/log/get",["require","blue/is","blue/log/var/loggers","blue/log/logger"],function(e){"use strict";var t=e("blue/is"),n=e("blue/log/var/loggers"),r=e("blue/log/logger");return function(e,o,i){if(!t.string(e))throw new TypeError('"name" must be a string');return n[e]=n[e]||new r(e,o,i),n[e]}}),define("blue/log/layout",["require","blue/is"],function(e){"use strict";function t(){this.batchHeader="",this.batchFooter="",this.batchSeparator="",this.batchSupport=!0,this.contentType="text/plain"}var n=e("blue/is");return t.prototype.format=function(){throw new Error("format() is not implemented")},t.prototype.stringify=function(e,t){var r,o,i,a="";if(n.null(e)||n.undefined(e))return a;try{return a=JSON.stringify(e)||"","{}"===a&&e instanceof Error&&(e.stack?a=e.stack.toString():e.name&&e.message&&(a=e.name.toString()+": "+e.message.toString())),n.defined(t)&&a.length>t?a.substring(0,t-3)+"...":a}catch(e){}if(n.array(e))for(o=0,i=e.length-1;o<=i;o++)a+=this.stringify(e[o],t),o<i&&(a+=",");else if(n.plainObject(e))for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a+=r.toString&&!n.null(e[r])&&n.defined(e[r])&&e[r].toString?r.toString()+"::"+e[r].toString()+"\n":"");else a=e.toString?e.toString():"";return n.defined(t)&&a.length>t?a.substring(0,t-3)+"...":a},t}),define("blue/log/layout/null",["require","blue/log/layout","blue/declare"],function(e){"use strict";var t=e("blue/log/layout");return e("blue/declare")(t,{constructor:function(){t.call(this),this.contentType="text/javascript"},format:function(e){return e}})}),define("blue/log/appender",["require","../declare","./level","./layout/null"],function(e){"use strict";var t=e("../declare"),n=e("./level"),r=e("./layout/null");return t({constructor:function(e,t){this.enabled=void 0===t||t,this.threshold=n[e]||n.ALL,this.layout=new r,this.start()},append:function(e){this.enabled&&(this.threshold.lessThan(e.level)||this.threshold.equals(e.level))&&this.doAppend(e)},destroy:function(){this.stop(),this.enabled=this.threshold=this.layout=void 0},doAppend:function(){throw new Error('"doAppend()" is not implemented')},start:function(){},stop:function(){this.enabled&&(this.enabled=!1)},toString:function(){return" Appender[ threshold: "+this.threshold+"]"}})}),define("blue/log/appender/console",["require","blue/log/appender","blue/has/all","blue/is","blue/declare"],function(e){"use strict";var t=e("blue/log/appender"),n=function(){}.call,r=e("blue/has/all"),o=e("blue/is"),i=e("blue/declare"),a={assert:function(e){console.assert(e.expression,e.message)},group:function(e){console.group(e.groupName)},groupEnd:function(){console.groupEnd()},log:function(e){if(o.plainObject(e)){var t=e.level.lowerCaseName,i=[];r("console-"+e.level.lowerCaseName)||(t="log");try{r("native-console")?console[t].apply(console,e.message):n.apply(console[t],[console].concat(e.message))}catch(n){e.message.forEach(function(e){try{i.push(JSON.stringify(e))}catch(e){}}),console[t](i.join(" "))}}},time:function(e){console.time(e.timerName)},timeEnd:function(e){console.timeEnd(e.timerName)}};return i(t,{constructor:function(e,n){t.call(this,e,n)},doAppend:function(e){var t=e.type.camelCaseName;o.array(e.message)&&e.message.unshift(e.loggerName),r("console-"+e.type.lowerCaseName)&&o.function(a[t])?a[t](e):a.log(e)}})}),define("blue/observable",["require","kefir","blue/perf","./model"],function(e){"use strict";var t=e("kefir"),n=e("blue/perf"),r=t.Property.prototype,o=t.Stream.prototype,i=r.onValue,a=r.filter,s=r.map,u=r.scan,c=o.onValue,l=o.filter,f=o.map,d=o.scan,p=Object.prototype.hasOwnProperty,h=function(){},m=0,g=function(e,t){return e&&e.emit(t),this},b=function(e,t){return e&&e.error(t),this},v=function(e){return e&&e.end(),this},y=function(e,t){return e&&e.emitEvent(t),this},x=function(e,t,n){var r,o,i,a,s=t[0]||n||h,u=typeof s,c=[];switch(u){case"function":for(c=[],r=1;r<t.length;r++)c.push(t[r]);o=function(e){return s.apply(null,c.concat([e]))};break;case"boolean":o=function(){return s};break;case"object":i=t[1],o=i?function(){return s[i].apply(s,arguments)}:h;break;case"string":for(s=s.substr(1),r=1;r<t.length;r++)c.push(t[r]);o=c.length?function(e){return e[s].apply(e,c)}:"boolean"==typeof n?function(e){return p.call(e,s)}:function(e){return e[s]}}return a=e.call(this,o),"function"==typeof n?o:a},w=function(e,t){var r=this,o="<stream:"+m+++">",i=x.call(this,e,t,h);return n.count.call({id:o,ref:t},"blue/observable","stream","onValue"),function(){n.count.call({id:o},"blue/observable","stream","offValue"),r.offValue(i)}},E=function(e){var t=function(t){var n;t.value=(n=t.value)&&function(){return n},e(t)};return this.onAny(t),function(){this.offAny(t)}},k=function(e,t){var r=this;return e.onAny(t.emitEvent),r.emit=function(e){return g.call(r,t,e)},r.push=this.emit,r.error=function(e){return b.call(r,t,e)},r.end=function(){return v.call(r,t)},r.emitEvent=function(e){return y.call(r,t,e)},n.count.call({add:"active"},"blue/observable","bus","activate"),function(){n.count.call({rem:"active"},"blue/observable","bus","deactivate"),e.offAny(t.emitEvent)}};return t.Model=e("./model"),t.once=function(e){return t.merge([t.constant(e),t.never()])},r.subscribe=function(e){return E.call(this,e)},o.subscribe=function(e){return E.call(this,e)},r.onValue=function(){return w.call(this,i,arguments)},o.onValue=function(){return w.call(this,c,arguments)},r.filter=function(){return x.call(this,a,arguments,!1)},o.filter=function(){return x.call(this,l,arguments,!1)},r.map=function(){return x.call(this,s,arguments)},o.map=function(){return x.call(this,f,arguments)},r.scan=function(e,t){return u.call(this,t,e)},o.scan=function(e,t){return d.call(this,t,e)},t.Bus=function(){var e=t.pool(),r=e.plug,o=e.unplug,i=t.stream(function(t){return k.call(i,e,t)});return e.plug=function(t){n.count.call({add:"plug"},"blue/observable","bus","plug"),r.call(e,t)},e.unplug=function(t){n.count.call({rem:"plug"},"blue/observable","bus","unplug"),o.call(e,t)},i.setName("bus"),i.id="<bus:"+m+++">",i.push=h,i.error=h,i.end=h,i.emitEvent=h,i.plug=function(t){return e.plug(t),function(){e.unplug(t)}},i.unplug=e.unplug,n.count.call({id:i.id,ref:{}},"blue/observable","bus","create"),i.onEnd(function(){n.count.call({id:i.id},"blue/observable","bus","destroy")}),i},t}),define("blue/string/wildCardMatch",[],function(){"use strict";return function(e,t,n){var r,o;return n=n||"*",t===n||(-1===t.indexOf(n)?e===t:(r="^"+t.split(n).join(".*?")+"$",o=new RegExp(r),o.test(e)))}}),define("blue/object/extend",["require","../is","mout/object/deepMixIn","mout/object/mixIn"],function(e){"use strict";var t=e("../is"),n=e("mout/object/deepMixIn"),r=e("mout/object/mixIn");return function(e){for(var o=t.boolean(e)?1:0,i=[];o<arguments.length;o++)i.push(arguments[o]);return!0===e?n.apply(this,i):r.apply(this,i)}}),define("blue/event",["require","./is","./string/wildCardMatch","./object/extend","./as/serializable"],function(e){"use strict";var t=e("./is"),n=e("./string/wildCardMatch"),r=e("./object/extend"),o=e("./as/serializable"),i=0,a=function(e,n){e instanceof a||t.defined(e)&&t.string(e.type)?(this.originalEvent=e,this.type=e.type):this.type=e,this.extend(n),this.eventId=++i,this.eventTimeStamp=t.defined(e)&&t.number(e.timestamp)||Date.now()};return a.prototype.extend=function(){var e,t=[!0,this];for(e=0;e<arguments.length;e++)t.push(arguments[e]);r.apply(this,t)},a.prototype.match=function(e,t){var r=this[e]||"";return n(r,t||"")},o.call(a.prototype,function(){return"<"+this.type+">"}),a}),define("blue/event/channel",["require","../observable","../is","../event","../object/extend","blue/perf"],function(e){"use strict";var t=e("../observable"),n=e("../is"),r=e("../event"),o=e("../object/extend"),i=e("blue/perf"),a=function(e){var t=e.split("/");switch(t.length){case 1:return{type:t[0]||"",value:"*"};case 2:return{type:t[0]||"",value:t[1]||""};default:return{type:"",value:""}}},s=0,u=0,c=0,l=function(e,r){var a={eventTarget:this,eventType:"data"};this.id=++s,this.settings=o(!0,{},a,e||{}),this.stream=n.defined(r)&&n.function(r.push)&&1===r.push.length&&n.function(r.end)&&n.function(r.filter)&&3===r.filter.length?r:new t.Bus,this.cleanup={},i.count.call({id:this.id,ref:this},"blue/event/channel","create",e&&e.eventTarget&&(e.eventTarget.name||e.eventTarget.__name))};return l.prototype.asEventStream=function(e){return n.function(e)?this.stream.filter(e):n.string(e)?this.stream.filter(".match","type",e):this.stream},l.prototype.destroy=function(){i.count.call({id:this.id},"blue/event/channel","destroy"),Object.keys(this.cleanup).forEach(function(e){this.cleanup[e]()},this),this.stream.end(),this.id=this.settings=this.stream=this.cleanup=void 0},l.prototype.emit=function(e,t){var o;e instanceof r?o=e:(n.string(e)?e=e:(t=e,e=this.settings.eventType),o=new r(e)),i.count("blue/event/channel","emit",o.type),n.plainObject(t)&&o.extend(t),n.undefined(o.target)&&(o.target=this.settings.eventTarget),this.stream.push(o)},l.prototype.on=function(e,t){n.function(e)&&(t=e,e="*");var r,o,s,l,f=[],d=function(e,t,n){return function(r){r.match("type",t)&&r.match("value",n)&&e(r)}},p=function(e){var t=c++,n="n"+t,r=this.cleanup;return r[n]=function(){r[n]&&(i.count.call({id:"listenerOn"+t,time:1},"blue/event/channel","off",n),delete r[n],e())},r[n]};return n.plainObject(e)?s=e:(s={},s[e]=t),Object.keys(s).forEach(function(e){o=s[e],o.listenId=u++,r=a(e),i.count.call({id:"listenerOn"+c,ref:{func:o,type:e},time:1},"blue/event/channel","on",e),l=this.stream.onValue(d(o,r.type,r.value)),f.push(p.call(this,l))},this),f},l.prototype.plug=function(e){return e.onValue(this,"emit")},l}),define("blue/event/channel/component",["require","../channel"],function(e){"use strict";return new(e("../channel"))}),define("blue/log/appender/analytics",["require","blue/log/appender","../layout","blue/is","blue/event/channel/component"],function(e){"use strict";function t(e,t,r,o){n.call(this,e,t),this.fieldLimit=r||1995,this.totalLimit=o||2e3,this.totalLess=this.totalLimit-4}var n=e("blue/log/appender"),r=new(e("../layout")),o=e("blue/is"),i=e("blue/event/channel/component");return t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.prototype.doAppend=function(e){var t=e.type.camelCaseName;-1===e.loggerName.indexOf("[blue-analytics]")&&this.supportedMethods[t]&&this.supportedMethods[t].call(this,e)},t.prototype.supportedMethods={log:function(e){if(o.plainObject(e)){var t=this,n=1===e.message.length?r.stringify(e.message[0],this.fieldLimit):e.message.reduce(function(e,n,o){return 0===o?e+r.stringify(n,t.fieldLimit):e+"\n "+r.stringify(n,t.fieldLimit)},"");i.emit("log",{timestamp:e.timestamp,data:{level:e.level.name,message:n.length<this.totalLimit?n:n.substring(0,this.totalLess)+"...."},logger:e.loggerName})}}},t}),define("blue/log/appender/consoleAnalytics",["require","blue/log/appender","blue/has/all","blue/is","../layout"],function(e){"use strict";function t(e,t,r,o){n.call(this,e,t),this.fieldLimit=r||1995,this.totalLimit=o||2e3,this.totalLess=this.totalLimit-4}var n=e("blue/log/appender"),r=function(){}.call,o=e("blue/has/all"),i=e("blue/is"),a=new(e("../layout"));return t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.prototype.doAppend=function(e){var t=e.type.camelCaseName;-1===e.loggerName.indexOf("[blue-analytics]")&&this.supportedMethods[t]&&this.supportedMethods[t].call(this,e)},t.prototype.supportedMethods={log:function(e){if(i.plainObject(e)){var t=this,n=e.level.lowerCaseName,s=1===e.message.length?a.stringify(e.message[0],this.fieldLimit):e.message.reduce(function(e,n,r){return 0===r?e+a.stringify(n,t.fieldLimit):e+"\n "+a.stringify(n,t.fieldLimit)},"");s=s.length<this.totalLimit?s:s.substring(0,this.totalLess)+"....",o("console-"+e.level.lowerCaseName)||(n="log");try{o("native-console")?console[n].apply(console,s):r.apply(console[n],[console].concat(s))}catch(e){console[n](s.join(" "))}}}},t}),define("blue/log",["require","exports","module","./log/get","./log/appender/console","./log/appender/analytics","./log/appender/consoleAnalytics","./is"],function(e,t,n){"use strict";var r,o,i,a,s,u=e("./log/get"),c=e("./log/appender/console"),l=e("./log/appender/analytics"),f=e("./log/appender/consoleAnalytics"),d=e("./is"),p=n.config(),h=["console","analytics","consoleAnalytics"],m=[c,l,f],g=[!0,!0,!1],b={};for(s=0;s<h.length;++s)r=p.appender&&p.appender[h[s]]&&d.defined(p.appender[h[s]].level)?p.appender[h[s]].level:"ALL",o=p.appender&&p.appender[h[s]]&&d.defined(p.appender[h[s]].enabled)&&d.boolean(p.appender[h[s]].enabled)?p.appender[h[s]].enabled:g[s],i=p.appender&&p.appender[h[s]]&&d.defined(p.appender[h[s]].fieldLimit)&&d.integer(p.appender[h[s]].fieldLimit)?p.appender[h[s]].fieldLimit:void 0,a=p.appender&&p.appender[h[s]]&&d.defined(p.appender[h[s]].totalLimit)&&d.integer(p.appender[h[s]].totalLimit)?p.appender[h[s]].totalLimit:void 0,b[h[s]]=new m[s](r,o,i,a);return function(e){var t=p[e]&&p[e].level||p.ALL&&p.ALL.level,n=p[e]&&d.defined(p[e].enabled)&&d.boolean(p[e].enabled)?p[e].enabled:!(p.ALL&&d.defined(p.ALL.enabled)&&d.boolean(p.ALL.enabled))||p.ALL.enabled,r=u(e,t,n);for(s=0;s<h.length;++s)b[h[s]].enabled&&r.addAppender(b[h[s]]);return r}}),define("blue/as/dataProvider",["blue/model","blue/log"],function(e,t){"use strict";var n=t("[dataprovider]"),r=function(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!0})},o=function(e,t,r,o){for(var i,a,s,u,c=e.model,l=e.services||{},f=e.mappers||{},d=t.split("."),p={dtm:Date.now(),params:r,options:o};(i=d.shift())&&(a=l)&&(l=l[i]||{});)f=f[i]||{};if(s=f.success||{},u=f.failure,!c||!c.lens)throw new Error("Invalid model");if("function"!=typeof l)throw new Error("Service not found: "+t);if("function"!=typeof s)throw new Error("Service success mapping function not found: "+t);return"function"!=typeof u&&n.warn("No failure callback provided: "+t),l.call(a,r,o).then(function(e){return s(p,e,c.get(),c)}).catch(function(e){return u&&u(p,e,c.get(),c)})};return function(t){var n,i,a={model:t.model||(n=e()),services:{},mappers:{}};return Object.defineProperty(a,"services",{get:function(){return i||(i=(t.context||{}).services||{})},enumerable:!0}),r(a,"request",function(e,t,n){return o(a,e,t,n)}),r(t,"dataProvider",a),{destroy:function(){n&&n.destroy()}}}}),define("blue/compose",["require","./is","mout/object/hasOwn"],function(e){"use strict";var t=e("./is"),n=e("mout/object/hasOwn"),r=function(e,r){e.mixedIn=n(e,"mixedIn")?e.mixedIn:[],r.forEach(function(n){-1===e.mixedIn.indexOf(n)&&(t.function(n)?n.call(e,e.context):Object.keys(n).forEach(function(t){e[t]=n[t]}),e.mixedIn.push(n))})};return function(e){var n,o=[],i=t.function(e)?0:1;for(n=i?e||Object.create(null):Object.create(null);i<arguments.length;i++)o.push(arguments[i]);return r(n,o),n}}),define("blue/as/constructable",["require","blue/compose","blue/is"],function(e){"use strict";var t=e("blue/compose"),n=e("blue/is");return function(){this.defineConstruct=function(e){Object.defineProperty(this,"construct",{set:function(r){if(n.function(r))t(this,function(){r.call(this,e)}.bind(this));else{if(!n.plainObject(r)&&!n.object(r))throw new TypeError("definition must be a function or object mixin");t(this,r)}},configurable:!0,enumerable:!1})},this.destroyConstruct=function(){delete this.construct}}}),define("blue/context",["require","./as/serializable","emitter-js","./is","blue/perf"],function(e){"use strict";var t,n=e("./as/serializable"),r=e("emitter-js"),o=e("./is"),i=e("blue/perf"),a=0,s=function(e){var n=function(n){Object.keys(n||{}).forEach(function(e){this[e]=n[e]},this),r.call(this),t=t||this.on,this.on=function(e,n){var r,o=this,i=n||e;switch(i&&i.constructor){case Function:return r=function(){try{i.apply(o,arguments)}catch(e){o.logger&&o.logger.error(e)}},r.listener=i,n?t.call(o,e,r):t.call(o,r);case Object:Object.keys(i).forEach(function(e){o.on(e,i[e])});break;case Array:i.forEach(function(t){if(n)return o.on(e,t);o.on(t)})}},Object.defineProperties(this,{id:{value:++a,configurable:!0},createdTimestamp:{value:Date.now(),configurable:!0}}),e||Object.defineProperties(this,{root:{value:this,configurable:!0}}),this.parent=this._ChildContext=this.children=null,i.count.call({id:this.id,ref:this},"blue/context",e?"createChild":"create")};return n.prototype=e,n},u=s();return u.prototype=Object.create(r.prototype),u.prototype.constructor=u,u.prototype.getStack=function(){var e=[],t=this;for(this.name&&e.unshift(this.name);t.parent;)t=t.parent,e.unshift(t.name);return e.join("/")},u.prototype.broadcast=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.direct(function(t){t.trigger(e,n)},!0)},u.prototype.bubble=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.escalate(function(t){t.trigger(e,n)},!0)},u.prototype.newChild=function(e){var t;return o.function(this._ChildContext)||(this._ChildContext=s(this),this.children=[]),t=new this._ChildContext(e),t.parent=this,this.children.push(t),t},u.prototype.hasChild=function(e){return e&&this.children&&-1!==this.children.indexOf(e)},u.prototype.removeChild=function(e){var t=e&&this.children&&this.children.indexOf(e);if(-1!==t&&"number"==typeof t)return this.children.splice(t,1),!0},u.prototype.destroy=function(){this.children&&this.children.length&&(this.direct(function(e){e.destroy()}),delete this.children),this.parent&&this.parent.removeChild(this),this._ChildContext&&delete this._ChildContext,r.prototype.destroy.call(this);var e=Object.getOwnPropertyNames(this),t=e.length;for(i.count.call({id:this.id},"blue/context","destroy");t--;)delete this[e[t]]},u.prototype.direct=function(e,t){var n=t?[this]:this.children;n&&n.length&&n.forEach(function(t){e(t),t.direct(e)})},u.prototype.escalate=function(e,t){var n=t?this:this.parent;n&&(e(n),n.escalate(e))},n.call(u.prototype,function(){return{ContextID:this.id||"empty id"}}),u}),define("blue/mixin",[],function(){"use strict";function e(e,t){return function(n){var r=n||{},o=this.prototype,i=o.constructor,a=function(){var n={self:this,shared:r},o=function(t){this[t]=function(){return e[t].apply(n,arguments)}};Object.keys(e||{}).forEach(o,this),t&&t.apply(n,arguments),i.apply(this,arguments)};return a.prototype=Object.create(o),Object.keys(this).forEach(function(e){a[e]=this[e]},this),a}}return e}),define("blue/as/contextual",["../context","../mixin"],function(e,t){var n=function(e,t){Object.keys(t||{}).forEach(function(n){e[n]=t[n]})},r=function(t,r){var o=this.shared.name,i=this.context=t?this.shared.inherit?t.newChild():t:new e;return o&&(i[o]=i),n(i,r),i},o=function(){var e=this.shared;void 0===e.inherit&&(e.inherit=!0)};return t({defineContext:function(e,t){var o=this;Object.defineProperty(this.self,"context",{get:function(){return o.context||r.call(o,e,t)},set:function(t){o.context?n(o.context,t):r.call(o,e,t)},configurable:!0,enumerable:!0})},destroyContext:function(){var e=this.self,t=e.context;t&&(t.destroy(),delete e.context),delete e.context,delete e.defineContext,delete e.destroyContext}},o)}),define("blue/deferred",["require","./declare"],function(e){"use strict";return e("./declare")({constructor:function(){var e,t;this.promise=new Promise(function(n,r){e=n,t=r}),this.resolve=e,this.reject=t},toString:function(){return"Deferred"}})}),define("blue/fetch",["require","blue/root","URI","blue/log"],function(e){"use strict"
;var t=e("blue/root"),n=e("URI"),r=e("blue/log")("[http:fetch]"),o=/%20/g,i=/^(?:GET|HEAD)$/,a={lastModified:{},etag:{}},s=function(e){return 0===e.status&&(t._phantom||t.callPhantom)&&"file:"===e.url.slice(0,5)},u={text:function(e){return e.text()},json:function(e){return e.json().catch(function(t){throw e.headers&&(t.headers=e.headers),e.status&&(t.status=e.status,t.statusText=e.statusText),t})},xml:function(e){return e.text().then(function(e){return(new DOMParser).parseFromString(e,"text/xml")})},image:function(e){return e._bodyBlob?Promise.resolve(e._bodyBlob):"function"==typeof e.blob?e.blob():e.body&&e.body instanceof ReadableStream?e:Promise.reject(new Error("Blue:fetch - expected image blob, blob not found"))}},c={text:u.text,"application/json":u.json,"text/json":u.json,"application/xml":u.xml,"text/xml":u.xml,"image/bmp":u.image,"image/gif":u.image,"image/x-icon":u.image,"image/jpeg":u.image,"image/png":u.image,"image/svg+xml":u.image,"image/tiff":u.image,"image/webp":u.image},l=function(e,t){var n=e.headers.get("Content-Type")||"",r=n.split("/"),o=u[t]||c[n]||c[r[0]];return o?o(e):e.text()},f=function(e){var t=[],n=function(e,n){var r;r=n&&n.constructor===Function?n():null===n?"":n,t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))};switch(e&&e.constructor){case Array:e.forEach(function(e){e&&n(e.name,e.value)});break;case Object:Object.keys(e).forEach(function(t){n(t,e[t])})}return t.join("&").replace(o,"+")},d=function(e){return n(e).absoluteTo(t.location.href).toString()};return function(e,n){var o,u,c,p,h=n||e&&e.constructor===Object&&e||{};return h.beforeSend&&h.beforeSend.constructor===Function&&(r.warn('DEPRECATED:BLUEJS-770:"beforeSend" is not a supported service option'),h.beforeSend({setRequestHeader:function(e,t){!("headers"in h)&&(h.headers={}),h.headers[e]=t}},h)),c=h.url||e,p={cache:"default",credentials:"same-origin",headers:h.headers||{},method:h.method||h.type||"GET",mode:"cors",redirect:"follow"},o=!h.data||h.data.constructor===String||"processData"in h&&!h.processData?h.data:f(h.data),o&&(i.test(p.method)?c+=(-1===c.indexOf("?")?"?":"&")+o:p.body=o),["complete","dataFilter","error","success","xhr"].forEach(function(e){h[e]&&r.warn('DEPRECATED:BLUEJS-770:"'+e+'" is not a supported service option')}),h.xhrFields&&h.xhrFields.withCredentials&&(p.credentials="include"),h.ifModified&&((u=a.lastModified[c])&&(p.headers["If-Modified-Since"]=u),(u=a.etag[c])&&(p.headers["If-None-Match"]=u)),h.contentType&&(p.headers["Content-Type"]=h.contentType),t.fetch(new t.Request(c),p).then(function(e){var t={headers:e.headers,status:e.status,statusText:e.statusText,url:e.url||d(c)};return e.ok||s(t)?(h.ifModified&&((u=e.headers.get("Last-Modified"))&&(a.lastModified[c]=u),(u=e.headers.get("etag"))&&(a.etag[c]=u)),l(e,h.dataType).then(function(e){return t.data=e,t})):e.text().then(function(e){throw t.data=e,t})}).catch(function(e){throw e.headers?e:{headers:new t.Headers,status:0,statusText:e.message,url:d(c)}})}}),define("blue/http",["require","blue/fetch","blue/perf"],function(e){"use strict";function t(e,t){var n=a.count.call({bucket:"service"},"blue/http",e.url||e),r=i(e,t);return r.then(n).catch(n),r.then(function(e){if(e.headers.get(o))throw e;return e.data}).catch(function(e){throw e.responseText=e.data,e.getResponseHeader=u,e.getAllResponseHeaders=c,e})}function n(e){return new Promise(function(n,r){try{var o=new XMLHttpRequest,i=function(){if(4===o.readyState)return 200!==o.status?r(o.statusText):void n()};o.open(t.method||"get",e,!0),o.onreadystatechange=i,setTimeout(function(){try{o.send(t.body)}catch(e){r()}},0)}catch(e){r()}})}function r(e,t){return new Promise(function(n,r){var o,i,a=document.getElementsByTagName("head")[0],u=function(e){return function(t){clearInterval(i),e(t)}},c=u(n),l=u(r);switch(t){case"css":o=document.createElement("link"),o.rel="stylesheet",o.href=e,i=setInterval(function(){Array.prototype.reduce.call(document.styleSheets||[],function(t,n){return t||n.href===e},!1)&&c()},100);break;case"js":o=document.createElement("script"),o.src=e;break;default:return l("unsupported resource type: "+t)}o.id=t+s++,o.onload=c,o.onerror=l,a.appendChild(o)})}var o="Alt-Location",i=e("blue/fetch"),a=e("blue/perf"),s=0,u=function(e){return this.headers.get(e)},c=function(){var e=[];return this.headers.forEach(function(t,n){e.push(n+":"+t)}),e.length?e.join("\r\n"):null};return{request:t,cache:n,append:r}}),define("blue/as/registry",["../compose","../deferred","../is","../perf","../root","../http","../log"],function(e,t,n,r,o,i,a){"use strict";var s=function(){},u=function(e){return e[0].toUpperCase()+e.slice(1)},c=Object.prototype.hasOwnProperty,l=!1,f=new Map,d=a("[blue:core]"),p=function(e){return f.get(e)||(f.set(e,{})||f).get(e)},h=function(e){f.delete(e)};return function(t,o,a){function f(e,t){var n;for(n in t)c.call(t,n)&&(e[n]=t[n])}function m(e){return n.function(e.addReady)&&n.function(e.appendTo)&&n.function(e.replaceIn)}function g(e,r,o){var a=p(e)[G][r]||{},s=a.dependencies||{},u=[];return n.thenable(s)?s:(s&&s.constructor===Object||(s={}),Object.keys(s).forEach(function(e){var n=i.append(e,s[e]).catch(function(){d.error("["+o.getStack()+"]","Unable to load-dependency for "+t+":"+r+" ("+e+")")});u.push(n)}),a.dependencies=Promise.all(u))}function b(e,i,s,u,c,l,h){var m,g,b={},y=p(e),x=y[G][i]||{};return r.count("blue/as/registry","construct",F,i),u&&d.info("["+u.getStack()+"]","Creating "+t+":"+i),n.object(s)?(f(b,s),f(b,x)):b=s,a.onCreate&&a.onCreate.call(y[$],i,b),o.create?l=o.create(i,u,b):(l=new o(i,u),g=v(i,u,b,l),N&&(m=n.promise(g)?g:Promise.resolve(g))),y[B].set(l,i),l.context.on(":destroy",function(){_||e["remove"+F](i),u.emit("blue:registry:"+t+":destroy",i)}),_||(c[i]=l),y[J][i]=!0,setTimeout(function(){e&&y[J]&&delete y[J][i]},0),N?m.then(function(e){return Promise.resolve(a.onAfterCreate?a.onAfterCreate.call(y[$],i,e):e).then(function(e){return u.emit("blue:registry:"+t+":create",i),e})}):(a.onAfterCreate&&a.onAfterCreate.call(y[$],i,b),u.emit("blue:registry:"+t+":create",i),l)}function v(t,r,i,a){var s,u,c;return a||(a=new o(t,r)),n.function(i)?(s=i.call(a,a.context),c=n.promise(s)?new Promise(function(n,r){s.then(function(t){e(a,t),n(a)},function(e){console.error("Unable to load area: ",t.toString())})}):Promise.resolve(a)):(e(a,i),c=Promise.resolve(a)),new Promise(function(e,t){c.then(function(o){if(u=r.site._internal.importer.importLibrary[o.context.getStack()],u=u?u[u.type]||u:void 0,n.function(o.onInit)?o.onInit.call(o,u):n.function(o.init)&&o.init.call(o,u),N){var i=o.imports?[r.site._internal.import(o,o.imports)]:[];Promise.all(i).then(function(){Promise.resolve(r.site._internal.importer.completeImport(o,o.context.getStack())).then(function(){if(!n.function(o.onComplete)||m(o))return e(o);Promise.resolve(o.onComplete(u)).then(function(){o.disableServiceAPI&&o.disableServiceAPI(),u&&u.services&&Object.keys(u.services).forEach(function(e){o.services[e].disableServiceAPI()}),e(o)})})}).catch(t)}else e(o)})})}function y(e,n,r,o){var i=p(e)[W],a=i[n],s="/"+n;if(!a)try{a=b(e,n,r,o,i,a,s),!_&&(i[n]=a)}catch(e){d.error("["+o.getStack()+"]","Problem creating "+t+" "+n,e)}return a}function x(e,t){r.count("blue/as/registry","remove",F,t);var n=p(e),o=n[W],i=o[t];return n[J][t]&&(d.warn("["+n[Q].getStack()+"]",["Created "+F+" "+t+" just to destroy it?","Use this.registry.has"+F+"('"+t+"')"," or this.registry.destroy"+F+"('"+t+"')"].join("\n")),delete n[J][t]),i&&(n[B].delete(i),delete o[t]),N?Promise.resolve(i):i}function w(e,r,o,i){var a=p(e),s=function(e,n,r,o){o.emit("blue:registry:"+t+":load",n);var i,s,u=U?(s=r.split("!"))&&s.splice(-1,0,U)&&s.join("!"):r,c=function(){return!o.env||!("onLine"in o.env)||o.env.onLine},f=function(e){e!==l&&o.bubble("blue:network:offline",e),l=e},d=new Promise(function(t,r){var s=function(s){f(!1),i=!0,w(e,n,s,o);try{t(a[V][n])}catch(e){r(e)}},l=function(t){var a,d=u.split("!"),p=d.pop();w(e,n,u,o);do{requirejs.undef(p)}while((a=d.pop())&&(p=requirejs.toUrl(a).slice(1)+"!"+p));c()?(f(!1),i=!0,r(t)):(f(!0),setTimeout(function(){return c()?requirejs([u],s,l):l(t)},500))};Blue.webpack?Blue.webpack.resolve(u,s,l):requirejs([u],s,l)});return!i&&w(e,n,d,o),g(e,n,o).then(function(){return d})},u=function(){return y(e,r,o,i)},c=function(){d.error("["+i.getStack()+"]","Cannot set registry "+F+" "+r+".")},f=n.string(o)?function(){return s(e,r,o,i)}:n.thenable(o)?function(){return o}:M?u()&&u:u;a[Y][r]=o,Object.defineProperty(a[V],r,{get:f,set:c,configurable:!0,enumerable:!0})}function E(e){return p(this)[V][e]}function k(e){return x(this,e)}function j(e){return e in p(this)[W]}function S(e){return e in p(this)[V]}function O(e){return e&&p(this)(B).get(e)}function P(e,n,o){r.count("blue/as/registry","register",F,e);var i=this,a=p(i)[Q];if(j.call(i,e)){if(!o)throw Error(F+" "+e+" already exists. Use the overwrite flag if needed.");k.call(i,e)}w(i,e,n,a),a.emit("blue:registry:"+t+":register",e)}function T(e){r.count("blue/as/registry","unregister",F,e);var n=this,o=p(n),i=k.call(n,e);return delete o[V][e],o[Q].emit("blue:registry:"+t+":unregister",e),i}function I(e,t){var n=this;Object.keys(e).forEach(function(r){P.call(n,r,e[r],t)})}function R(e,t){r.count("blue/as/registry","update",F,e);var n=this,o=p(n);S.call(n,e)&&("object"==typeof t?o[G][e]=t:t||delete o[G][e])}function C(e,t,n){r.count("blue/as/registry","clone",F,e,t);var o=this,i=p(o)[Y][e];if(!i)throw Error(F+" "+e+" does not exist");P.call(o,t,i,!0),n&&R.call(o,t,n)}function L(e){var t=this,r=p(t),o=r[W][e],i=function(t){if(t&&t.destroy&&!t.destroy.constructor!==Function){var o=t.destroy();return n.thenable(o)?(o.catch(function(t){d.error("["+r[Q].getStack()+"]",F+" "+e+" did not destroy successfully",t)}),o):void 0}};return x(t,e),n.thenable(o)?o.then(i):Promise.resolve(o&&i(o))}function q(){var e=this,t=p(e),n=[];return Object.keys(t[V]).forEach(function(r){delete t[V][r],n.push(L.call(e,r))}),Promise.all(n)}function A(){var e=this.registry,n=p(e),r=q.call(e);return r.catch(function(){}).then(function(){Object.keys(n).forEach(function(e){0===e.indexOf(t)&&delete n[e]}),Object.keys(e).forEach(function(t){t.indexOf(F)>0&&delete e[t]}),Object.keys(e).length||(delete this.registry,h(e)),delete this[H],delete this[Z]}),r}if(!n.string(t)||!t.length)throw new TypeError("type must be a non-empty string");a=a||{};var N=a.lazy,_=a.noCache,M=a.immediate,U=a.plugin||"",D=this,H=t+"s",F=u(t),z=F+"s",B="key",$="host",V=H,W=t+"Store",Y=t+"Desc",J=t+"Temp",G=t+"Updates",Q=t+"Context",X="define"+z+"Registry",Z="destroy"+z+"Registry";D[X]=function(e){var t,n,r=this.registry;r?t=p(r):(this.registry=r=Object.create(null),t=p(r),t[$]=this),Object.defineProperty(this,H,{set:function(e){e?n?e!==t[V]&&this.context&&d.error("["+this.context.getStack()+"]",H+" can only be set once per registry"):(I.call(r,e),n=!0):(q(),n=!1)},get:function(){var e=t[V];return n||Object.keys(e).length?e:void 0},configurable:!0,emumerable:!0}),t[V]=Object.create(null),t[Y]=Object.create(null),t[W]=Object.create(null),t[J]=Object.create(null),t[G]=Object.create(null),t[B]=new Map,t[Q]=e,r["clone"+F]=C,r["destroy"+F]=L,r["destroy"+z]=q,r["get"+F]=E,r["has"+F]=j,r["is"+F]=S,r["keyFor"+F]=O,r["register"+F]=P,r["register"+z]=I,r["remove"+F]=k,r["unregister"+F]=T,r["update"+F]=R,r["get"+z]=function(){return t[V]},this[X]=s,this[Z]=A}}}),define("blue/device/lang",["require","../has/all","../root"],function(e){"use strict";var t,n=e("../has/all"),r=e("../root");return t=r.navigator,n("navigator-languages")?t.languages[0]:n("navigator-userlanguage")?t.userLanguage:n("navigator-language")?t.language:""}),define("blue/device/screen",["require","../has/all","../root"],function(e){"use strict";var t=e("../has/all"),n=e("../root");return t("screen")?n.screen:{width:0,height:0}}),define("blue/device/screen/dimensions",["require","../screen"],function(e){"use strict";var t=e("../screen");return{width:t.width,height:t.height}}),define("blue/dom/dimensions",["require","../has/all","../root","./body"],function(e){"use strict";var t,n,r=e("../has/all"),o=e("../root"),i=e("./body");return r("dom")&&o.addEventListener("resize",function(){t=i.clientHeight,n=i.clientWidth}),function(){return void 0===t&&(r("dom")?(t=i.clientHeight,n=i.clientWidth):t=n=0),{width:n,height:t}}}),define("blue/device",["require","./has/all","./device/lang","./device/screen/dimensions","./dom/dimensions","./device/platform"],function(e){"use strict";e("./has/all");var t=e("./device/lang"),n=e("./device/screen/dimensions"),r=e("./dom/dimensions"),o=e("./device/platform");return{dimensions:{screen:n,window:r()},lang:t,shortLang:t?t.split("-")[0]:"",userAgent:o.ua}}),define("blue/dom/body/dimensions",["require","../../has/all","../body"],function(e){"use strict";var t=e("../../has/all"),n=e("../body");return function(){var e,r;return t("dom")?(e=Math.max(n.scrollHeight,n.offsetHeight,n.clientHeight),r=Math.max(n.scrollWidth,n.offsetWidth,n.clientWidth)):(e=0,r=0),{width:r,height:e}}}),define("blue/importer",["require","./is","mout/object/merge","./root","./deferred","URI","./log"],function(e){"use strict";function t(e){return e[0].toUpperCase()+e.slice(1)}function n(e){return e.application?"application":e.area?"area":e.controller?"controller":e.component?"component":""}function r(){return arguments.length?Array.prototype.join.call(arguments,"/"):""}function o(e,t){return e?t?e.replace(/^\.\//,t+"/"):e:""}function i(e,t,n){var r=o(t,n);return new Promise(function(n,o){c.require([r],function(e){n(e)},function(n){d.error("["+e.getStack()+"]","Site importer failed to load-module ("+t+")",n),e.broadcast("blue:site:error:importerLoadModuleFailed",{code:"blue:site:error:importerLoadModuleFailed",description:"Site importer failed to load module ("+t+")"+n}),o(n)})})}function a(e,t,n,i,a){var c={},l=function(){c=u({},t),c.block?c.loadPath=o(c.block,n):(c.module=c.module||r(i,e),c.loadPath=o(c.module,n))},f=function(){c.module=r(i,e),c.loadPath=o(c.module,n)};return a&&1!==a?2===a&&(s.plainObject(t)?l():f()):s.string(t)?function(){c.block=t,c.loadPath=o(t,n)}():s.plainObject(t)?l():f(),c.version=a,c}var s=e("./is"),u=e("mout/object/merge"),c=e("./root"),l=e("./deferred"),f=e("URI"),d=e("./log")("[blue:core]"),p=function(e){this.site=e,this.importMap={},this.importLibrary={}};return p.prototype=Object.create(null),p.prototype.constructor=p,p.prototype.isImport=function(e){return void 0!==this.importLibrary[e]},p.prototype.registerView=function(e,t,n){this.site.tellPage("importer:registerView",{contextStack:e,viewName:t,viewPath:n})},p.prototype.completeImport=function(e,u){var c,l=this,f=["area","controller","component"],p=l.importLibrary[u]||{},h=n(p),m=p[h],g=[];if(m)return c=m.version||1,m._immediate={},m.viewPath?(e.viewPath={},m.viewPath.prefix&&(e.viewPath.prefix=o(m.viewPath.prefix,u)),m.viewPath.suffix&&(e.viewPath.suffix=o(m.viewPath.suffix,u))):p._local||(e.viewPath={prefix:o("./views/",u)}),m.viewEngine&&(e.context.viewEngine=m.viewEngine),f.forEach(function(n){var o=n+"s",f=m[o];f&&e.registry["register"+t(n)]&&(m._immediate[o]=[],Object.keys(f).forEach(function(t){var d;1===c&&s.string(f[t])&&(f[t]=a(t,f[t],u,".",c)),s.string(f[t].block)?(l.registerRequireMap(e,t,f[t].block),g.push(i(l.site.context,r(f[t].block,"manifest")).then(function(n){var i=a(t,n,u,r(".",o),n.version);return m&&m.components&&m.components[t]&&m.components[t].kind&&i.component&&(i.component.kind=m.components[t].kind),l.importBlock(e,t,i)}))):(l.registerRequireMap(e,t,l.importMap[u]),d={_local:!0,version:c},d[n]=a(t,f[t],u,r(".",o),c),g.push(l.importBlock(e,t,d))),f[t].immediate&&m._immediate[o].push(t)}))}),m.services&&e.registry.registerService&&(m.defaultServiceInterceptors&&(m.loadedDefaultServiceInterceptors=[],m.defaultServiceInterceptors.forEach(function(e,t){m.defaultServiceInterceptors[t]=o(e,u),g.push(i(l.site.context,m.defaultServiceInterceptors[t]).then(function(e){m.loadedDefaultServiceInterceptors.push(e)}))})),e.context.services=Object.hasOwnProperty.call(e.context,"services")?e.context.services:{},Object.keys(m.services).forEach(function(t){var n=m.services[t]=a(t,m.services[t],u,r(".","services"),c);n||d.error("["+e.context.getStack()+"]","Importer failed to load-service due to error in manifest"),e.registry.registerService(t,n.loadPath),n.interceptors&&(n.loadedInterceptors=[],n.interceptors.forEach(function(e,t){n.interceptors[t]=o(e,u),g.push(i(l.site.context,n.interceptors[t]).then(function(e){n.loadedInterceptors.push(e)}))})),g.push(e.services[t].then(function(n){e.context.services[t]=n}))})),m.routeMappings&&e.addRouteMapping&&(m.routeMappings.forEach(function(e,t){e.module,m.routeMappings[t].loadPath=o(e.module,u),g.push(i(l.site.context,e.module).then(function(t){e.loadedModule=t}))}),m.routeInterceptors&&(m.loadedRouteInterceptors=[],m.routeInterceptors.forEach(function(e,t){m.routeInterceptors[t]=o(e,u),g.push(i(l.site.context,m.routeInterceptors[t]).then(function(e){m.loadedRouteInterceptors.push(e)}))}))),Promise.all(g).then(function(){var t=[];return m.services&&Object.keys(m.services).forEach(function(t){m.services[t].loadedInterceptors?m.services[t].loadedInterceptors.forEach(function(n){e.context.services[t].addInterceptor(n)}):m.loadedDefaultServiceInterceptors&&m.loadedDefaultServiceInterceptors.forEach(function(n){e.context.services[t].addInterceptor(n)})}),m.routeMappings&&e.addRouteMapping&&(m.routeMappings.forEach(function(t){e.addRouteMapping(t.loadedModule,t.config)}),(m.loadedRouteInterceptors||[]).forEach(function(t){e.addRouteInterceptor(t)})),Object.keys(m._immediate).forEach(function(n){m._immediate[n].forEach(function(r){t.push(e[n][r])})}),delete m._immediate,Promise.all(t)})},p.prototype.importBlock=function(c,d,p){var h,m,g=this,b=!p._local,v=r(c.context.getStack(),d),y=new l,x=u({},p),w=x.type=n(x),E=x[w],k={};switch(h=x.version||1,g.importLibrary[v]=x,c.registry["register"+t(w)]&&(x[w]=E=b?a(w,E,v,".",h):a(d,E,v,r(".",w+"s"),h)),w){case"application":case"area":case"controller":c.registry["register"+t(w)](d,E.loadPath),y.resolve();break;case"component":E.spec=s.string(E.spec)?o(E.spec,v):b?o(r(".","spec"),v):o(r(".","components","specs",d),v),Promise.all([i(g.site.context,E.loadPath),i(g.site.context,E.spec)]).then(function(e){var t=e[0],n=e[1],r=u({},E,{methods:t,spec:n});x.viewEngine&&(r.viewEngine=x.viewEngine),c.registry.registerComponent(d,r,!0),y.resolve()}).catch(y.reject);break;default:return delete g.importLibrary[v],y.reject(new Error(w?'Unable to import block "'+d+'" into target '+c.context.getStack()+" : improper type for this target":'Unable to import block "'+d+'" : unknown block type')),y.promise}return E.loadPath&&E.dependencies&&E.dependencies.constructor===Object&&(m=e.toUrl(E.loadPath))&&(m=f("./",m).toString().replace(/\/js\/$/,"/"),Object.keys(E.dependencies).forEach(function(e){var t=f(e,m).toString();k[t]=E.dependencies[e]}),c.registry["update"+t(w)](d,{dependencies:k})),Object.keys(x.views||{}).forEach(function(e){g.registerView(c.context.getStack(),r(d,e),o(s.string(x.views[e])?x.views[e]:r(".","views",e),v))}),y.promise},p.prototype.registerRequireMap=function(e,t,n){var o={map:{"*":{}}},i=r(e.context.getStack(),t);o.map["*"][i]=n,c.require.config(o),this.importMap[i]=n},p.prototype.applyImports=function(e,t){var n,o=this,a=[],s=function(t){var a=n,s=e.context.getStack();t(i(o.site.context,r(s,a,"manifest")).then(function(t){return o.importBlock(e,a,t)}))};for(n in t)Object.hasOwnProperty.call(t,n)&&(o.registerRequireMap(e,n,t[n]),a.push(new Promise(s)));return Promise.all(a)},p}),define("blue/hash",["require","blue/dom","blue/root","URI"],function(e){"use strict";var t=e("blue/dom"),n=e("blue/root"),r=e("URI"),o=function(){try{return n.history&&n.history.state?n.history.state:1}catch(e){return 1}};return r.getURL=function(){return t.location.toString()},r.getHash=function(e){return void 0===e?r().fragment():r(e).fragment()},r.setHash=function(e){location.hash=e||""},r.replaceHash=function(e){var t=new r,n=o(),i=e||"";t.hash(i),history.replaceState(n,"",t.toString())},r.getHashArr=function(e){var t=e;return t||(t=r.getHash()),t.replace(/^\//,"").split(/[\/|?]/)},r.getParamsStr=function(e){return(e?r(e):r()).query()},r.getParamsObj=function(e){return(e?r(e):r()).query(!0)},r.getParamsArr=function(e){var t,n=e||r.getURL(),o=r.getParamsStr(n),i=o?r.getParamsObj(n):{};return""===o?(t=r.getHashArr(),t=t.splice(3,t.length)):t=Object.keys(i).map(function(e){return i[e]}),t},r.getCanonicalRoute=function(e){var t=e||r.getHash(r.getURL());return r.parseMatrixParamHash(t).path},r.parseSegment=function(e){var t,n,r,o,i=e.split(";"),a=decodeURIComponent(i[0]),s={};for(o=i.length-1;o>0;o--)i[o].length&&(t=i[o].indexOf("="),n=decodeURIComponent(i[o].substr(0,t)),r=t?i[o].substr(t+1):"",r=r.indexOf(",")>-1?r.split(",").map(function(e){return decodeURIComponent(e)}):decodeURIComponent(r),s[n]=r);return{name:a,params:s}},r.segmentObjectToString=function(e){var t="";return Object.keys(e.params).sort().forEach(function(n){var r=encodeURIComponent(n),o="";void 0===e.params[n]?t+=";"+r+"=":Array.isArray(e.params[n])?(o=e.params[n].map(function(e){return encodeURIComponent(e)}).join(","),t+=";"+r+"="+o):(o=encodeURIComponent(e.params[n].toString()),t+=";"+r+"="+o)}),encodeURIComponent(e.name)+t},r.parseFragment=function(e){var t={},n=r.getHash(e).replace(/^\/+/,""),o=n.split("?"),i=o[0].split("/");return t.segments=[],i.forEach(function(e){e.length&&t.segments.push(r.parseSegment(e))}),t.query={},t.query.string=o[1]||"",t.query.params=r.getParamsObj(e)||{},t},r.addSegmentToCurrentHash=function(e,t){var n=r.parseFragment(),o=[],i="";n.segments.push({name:e,params:t||{}}),o=n.segments.map(function(e){return r.segmentObjectToString(e)}),i="/"+(n.query.string?o.join("/")+"?"+n.query.string:o.join("/")),r.replaceHash(i)},r.parseMatrixParamHash=function(e){var t,n,o,i,a=e.split("?",2),s=a[0]?a[0].substr(1):"",u=s?s.split("/"):[],c=u.length,l=[],f={},d="",p="",h="",m="";return u.forEach(function(e,t){var n=r.parseSegment(e);l.push(n.name),f[t]=n.params}),c&&(d=l[0],t=f[0]?f[0]:{}),2!==c&&3!==c||"index"!==l[1]||(h="index",o=f[1]?f[1]:{},m="index",i=f[2]?f[2]:{}),4===c&&(p=l[1],n=f[1]?f[1]:{},h=l[2],o=f[2]?f[2]:{},m=l[3],i=f[3]?f[3]:{}),{hash:e,path:"/"+l.join("/"),pathOnly:"/"+s,pathSegments:l,pathSegmentParams:f,rawSegments:u,queryString:r(e).query(),queryParams:r.getParamsObj(e),matrixParams:f,app:d,appParams:t||{},area:p,areaParams:n||{},controller:h,controllerParams:o||{},action:m,actionParams:i||{}}},r}),define("blue/resolver",["require","./is","./as/serializable","./observable"],function(e){"use strict";function t(e){e||(e={}),this.prefix=e.prefix||"",this.suffix=e.suffix||""}var n=e("./is"),r=e("./as/serializable"),o=e("./observable");return t.prototype.createId=function(e,t){t||(t={});var n="",r=t.prefix||this.prefix,o=t.suffix||this.suffix;return r&&0!==e.indexOf(r)&&(e.match(/^\//)?e=e.replace(/^\//,""):n+=r),n+=e,o&&(n+=o),n},t.prototype.load=function(){throw new Error('"load()" is not implemented')},t.prototype.resolve=function(e,t){return t||(t={}),n.string(e)?this.load(this.createId(e,t)):o.once(e)},r.call(t.prototype,function(){return"Resolver[ prefix:"+this.prefix+" suffix: "+this.suffix+"]"}),t}),define("blue/resolver/module",["require","../resolver","../observable","../declare","../root","../has","blue/log"],function(e){"use strict";var t,n,r=e("../resolver"),o=e("../observable"),i=e("../declare"),a=e("../root"),s=e("../has"),u=e("blue/log");return Blue.status.applicationLoaded.then(function(){t=u("[ModuleResolver]"),n=!0}),i(r,{constructor:function(){r.apply(this,arguments)},load:function(e){return s("webpack-resolve")?o.fromNodeCallback(function(t){Blue.webpack.resolve(e.replace("wire!",""),function(e){t(null,e)},function(e){t(e)})}):o.fromNodeCallback(function(r){a.requirejs([e],function(e){r(null,e)},function(e){if(n)for(var o in a.requirejs.s.contexts._.registry)a.requirejs.s.contexts._.registry[o].error&&t.error('Requirejs failed to load module "'+o+'" failed to load due to error: ',e);r(e)})})},toString:function(){return"Module Resolver"}})}),function(e,t,n){function r(e){var t=this,n=a();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+1.1102230246251565e-16*(2097152*a()|0)},a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}function a(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)}}t&&t.exports?t.exports=i:n&&n.amd?n("alea",[],function(){return i}):this.alea=i}(0,"object"==typeof module&&module,"function"==typeof define&&define),define("blue/random",["require","alea"],function(e){"use strict";return e("alea")(function(){try{var e=new Uint8Array(256);return crypto.getRandomValues(e),String.fromCharCode.apply(0,e)}catch(e){return String(Date.now())}}(),{entropy:!0}).double}),define("blue/util",["require","mout/array/combine","mout/array/compact","mout/lang/deepEquals","mout/array/difference","mout/array/find","mout/array/flatten","mout/array/groupBy","mout/array/intersection","mout/array/invoke","mout/array/max","mout/array/min","mout/array/pick","mout/array/pluck","mout/array/range","mout/array/sort","mout/array/union","mout/array/unique","mout/function/compose","mout/function/debounce","mout/function/partial","mout/function/prop","mout/function/series","mout/function/times","mout/function/wrap","mout/lang/defaults","mout/object/equals","mout/object/every","./object/extend","mout/lang/deepClone","mout/lang/deepEquals","mout/object/deepMatches","mout/object/filter","mout/object/find","mout/object/functions","mout/object/get","mout/object/has","mout/object/map","mout/object/matches","mout/object/max","mout/object/merge","mout/object/min","mout/object/mixIn","mout/object/pick","mout/object/pluck","mout/object/set","mout/lang/toString","mout/object/unset","mout/random/choice","mout/random/guid","mout/random/rand","mout/random/randHex","mout/random/randInt","mout/random/random","./string/toComponentName","mout/string/hyphenate","mout/string/interpolate","mout/string/makePath","mout/string/properCase","mout/string/removeNonASCII","mout/string/removeNonWord","mout/string/stripHtmlTags","mout/lang/toNumber","mout/string/trim","mout/string/truncate","mout/string/typecast","mout/string/unCamelCase","mout/string/unhyphenate","mout/string/WHITE_SPACES"],function(e){"use strict";var t=function(e){var t=document.createElement("pre"),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML},n=function(e){var t=document.createElement("div");return e.replace(/\&[#0-9a-z]+;/gi,function(e){return t.innerHTML=e,t.innerText})};return{array:{combine:e("mout/array/combine"),compact:e("mout/array/compact"),deepEquals:e("mout/lang/deepEquals"),difference:e("mout/array/difference"),find:e("mout/array/find"),flatten:e("mout/array/flatten"),groupBy:e("mout/array/groupBy"),intersection:e("mout/array/intersection"),invoke:e("mout/array/invoke"),max:e("mout/array/max"),min:e("mout/array/min"),pick:e("mout/array/pick"),pluck:e("mout/array/pluck"),range:e("mout/array/range"),sort:e("mout/array/sort"),union:e("mout/array/union"),unique:e("mout/array/unique")},function:{compose:e("mout/function/compose"),debounce:e("mout/function/debounce"),partial:e("mout/function/partial"),prop:e("mout/function/prop"),series:e("mout/function/series"),times:e("mout/function/times"),wrap:e("mout/function/wrap")},lang:{defaults:e("mout/lang/defaults")},object:{equals:e("mout/object/equals"),every:e("mout/object/every"),extend:e("./object/extend"),deepClone:e("mout/lang/deepClone"),deepEquals:e("mout/lang/deepEquals"),deepMatches:e("mout/object/deepMatches"),filter:e("mout/object/filter"),find:e("mout/object/find"),functions:e("mout/object/functions"),get:e("mout/object/get"),has:e("mout/object/has"),map:e("mout/object/map"),matches:e("mout/object/matches"),max:e("mout/object/max"),merge:e("mout/object/merge"),min:e("mout/object/min"),mixIn:e("mout/object/mixIn"),pick:e("mout/object/pick"),pluck:e("mout/object/pluck"),set:e("mout/object/set"),toString:e("mout/lang/toString"),unset:e("mout/object/unset")},random:{choice:e("mout/random/choice"),guid:e("mout/random/guid"),rand:e("mout/random/rand"),randHex:e("mout/random/randHex"),randInt:e("mout/random/randInt"),random:e("mout/random/random")},string:{camelCase:e("./string/toComponentName"),escapeHtml:t,hyphenate:e("mout/string/hyphenate"),interpolate:e("mout/string/interpolate"),makePath:e("mout/string/makePath"),properCase:e("mout/string/properCase"),removeNonASCII:e("mout/string/removeNonASCII"),removeNonWord:e("mout/string/removeNonWord"),stripHtmlTags:e("mout/string/stripHtmlTags"),toNumber:e("mout/lang/toNumber"),trim:e("mout/string/trim"),truncate:e("mout/string/truncate"),typecast:e("mout/string/typecast"),unCamelCase:e("mout/string/unCamelCase"),unescapeHtml:n,unhyphenate:e("mout/string/unhyphenate"),WHITE_SPACES:e("mout/string/WHITE_SPACES")}}}),define("blue/context/root",["blue/context","blue/is","blue/log","blue/util","module"],function(e,t,n,r,o){var i=new e,a=o.config();return i.name="ROOT",i.is=t,i.util=r,i.logger=n("[root]"),i.config=a,i}),define("blue/intercept",["require","meld"],function(e){"use strict";var t=e("meld");return t.withAdvice=function(){["after","afterReturning","afterThrowing","around","before","on"].forEach(function(e){this[e]=function(n,r){var o=this[n],i=r.bind(this);return this[n]="function"==typeof o?t[e](o,i):i}},this)},t.withInterceptors=function(e){function n(n,r){n._removers.push(t(n,e,"function"==typeof r?r():r))}this.addInterceptor=function(e){this._removers.length||(this._interceptors=[]),-1===this._interceptors.indexOf(e)&&(this._interceptors.push(e),n(this,e))},this.addInterceptors=function(e){var t,n=e.length;for(t=0;t<n;t++)this.addInterceptor(e[t])},this.setInterceptors=function(e){var t,n=Array.isArray(e)?e:[e],r=n.length;for(this.destroyInterceptors(),this._interceptors=[],this._removers=[],t=0;t<r;t++)this.addInterceptor(n[t]);Object.defineProperty(this,"interceptors",{set:this.setInterceptors,configurable:!0,enumerable:!1})},this.defineInterceptors=function(){var e=this.interceptors||[];this._interceptors=[],this._removers=[],Object.defineProperty(this,"interceptors",{set:this.setInterceptors,configurable:!0,enumerable:!1}),this.interceptors=e},this.destroyInterceptors=function(){this.disableInterceptors(),delete this._interceptors,delete this._removers,delete this.interceptors},this.disableInterceptors=function(){for(var e;e=this._removers.pop();)e.remove()},this.enableInterceptors=function(){var e,t=this._interceptors.length;for(this.disableInterceptors(),e=0;e<t;e++)n(this,this._interceptors[e])},this.removeInterceptor=function(e){var t=this._interceptors.indexOf(e);-1!==t&&this._interceptors.splice(t,1)}},t}),define("blue/event/channel/screen",["require","../channel"],function(e){"use strict";return new(e("../channel"))}),define("blue/router",["require","blue/as/contextual","blue/hash","blue/intercept","blue/is","blue/log","blue/root","blue/event/channel/screen"],function(e){"use strict";var t,n,r=e("blue/as/contextual"),o=e("blue/hash"),i=e("blue/intercept"),a=e("blue/is"),s=e("blue/log")("[site]"),u=e("blue/root"),c=e("blue/event/channel/screen"),l=!1,f=/(^[^\/])/g,d=/^\//,p=/([^:])\/{2,}/g,h=/\?{2,}/g,m=/\/$/,g=1,b=0,v={},y=!1,x=function(){return b+=1},w=function(){try{return u.history&&u.history.state?u.history.state:1}catch(e){return 1}},E=function(e){var t,n,r,i=e;return i&&"#"!==i[0]&&(i="#"+i),t=o.getHash(i),r=t,
n=f.test(t)||p.test(t)||h.test(t)||m.test(t),n&&(r=t.replace(f,"/$1").replace(p,"$1/").replace(h,"").replace(m,"")),r},k=function(e){var t,n=e;return n?(t=n.indexOf("#"),t>=0&&(n=n.length<=t+1?"":n.substr(t+1)),d.test(n)?n.substr(1):n):""},j=function(e){var t={},n=k(e),r=n.split("?"),i=r[0].split("/");return t.segments=[],i.forEach(function(e){e.length&&t.segments.push(o.parseSegment(e))}),t.query={},t.query.string=r[1]||"",t.query.params=o.getParamsObj(e)||{},t},S=function(e,t,r){var o=r.source,i=r.historyState?r.historyState:1,s={oldRoute:n,newRoute:r.route,source:o||"external",privateDataObject:r.privateDataObject},c={parseRoute:j};v[t]||(v[t]={source:r.source,historyState:i},e.context.site.emit("blue:route:newRouteRequest",{msgType:"blue:route:newRouteRequest",id:t,source:o,route:r.route}),e._executeRoute(e.context,s,c,t),!u.history||v[t].done||"external"!==o||!a.undefined(n)&&r.route===n||(y=!0,e.context.site.emit("blue:route:newRouteRequestAborted",{msgType:"blue:route:newRouteRequestAborted",id:t,source:o,route:r.route}),i?u.history.go(g-i):u.history.go(-1),v[t].done="aborted"))},O=function(e,t){var n=this;this.name="router",this.defineContext(t),this.defineInterceptors(),this.context.on("publicRoute",function(e){var t=E(e.route),r=x();S(n,r,{source:"public",route:t,historyState:w()})}),this.context.on("privateRoute",function(e){var t=E(e.route),r=x();S(n,r,{source:"private",route:t,historyState:w(),privateDataObject:e.privateDataObject})})};return O.prototype=Object.create(null),O.prototype.constructor=O,O.prototype._executeRoute=function(e,t,r,i){var s,l=v[i],f=t.source||"external",d=t.newRoute,p=o.parseMatrixParamHash(d),h=j(d);h.source=f,"private"===f?(p.mapping=p.pathSegments.join("."),e.site.emit("blue:route:newRouteExecuting",{msgType:"blue:route:newRouteExecuting",id:i,source:f,route:d}),h.privateDataObject=t.privateDataObject,e.site.emit("processRoute",h)):setTimeout(function(){u.history&&"external"===f&&(s=l.historyState,o.replaceHash(d),g=s),a.undefined(n)||d!==n?(n=d,p.mapping=p.pathSegments.join("."),"public"===f&&(s=g+1,u.history&&u.history.pushState(s,void 0,"#"+d),g=s),e.parent.routeHistory.saveRoute("site",d),e.site.emit("blue:route:newRouteExecuting",{msgType:"blue:route:newRouteExecuting",id:i,source:f,route:d}),e.site.emit("processRoute",h),u.location&&c.emit("screen",{oldUrl:e.parent.routeHistory.lastRoute(),newUrl:u.location.href,canonicalRoute:o.getCanonicalRoute()})):(e.site.emit("blue:route:newRouteRequestAborted",{msgType:"blue:route:newRouteRequestAborted",id:i,source:f,route:d}),e.site.logger.warn("Router public state change ignored: destination URL matches current URL "+d))},0),v[i].done="complete"},O.prototype.updateHash=function(e){var t=E(e);u.history&&u.history.replaceState(w(),void 0,"#"+t),n=t},O.prototype.hashChangeListen=function(){var e=this;u.history&&(u.onhashchange=function(t){var n="",r=x(),i=g+1;y?y=!1:(n=E(o.getHash(t.newURL)),w()===g&&u.history.replaceState(i,void 0,"#"+n),S(e,r,{source:"external",route:n,historyState:w()}))})},O.prototype.handleInitialRoute=function(){var e=E(),t=x();S(this,t,{source:"external",route:e,historyState:w()})},O.prototype.init=function(e){var n=o.getHashArr(),r=n[0]?n[0].split(";")[0]:"";if(t=appRoutes&&appRoutes[0]?appRoutes[0]:"app",l)return void s.debug("!!!! ROUTER SHOULD ONLY BE INITIALIZED ONCE");l=!0,e&&this.addInterceptors(e),""!==o.getHash()?t!==r&&(this.context.parent.routeHistory.saveRoute("site"),this.context.parent.routeHistory.saveRoute("redirect"),o.replaceHash(t)):o.replaceHash(t)},O=r.call(O,{name:"router"}),i.withInterceptors.call(O.prototype,"_executeRoute"),O}),define("blue/store",["require","./is","./declare"],function(e){"use strict";var t=e("./is");return e("./declare")({constructor:function(e){if(!t.string(e))throw new TypeError('"name" is not a string');this.name=e},clear:function(){throw new Error('"clear()" is not implemented')},get:function(){throw new Error('"get()" is not implemented')},has:function(){throw new Error('"has()" is not implemented')},remove:function(){throw new Error('"remove()" is not implemented')},set:function(){throw new Error('"set()" is not implemented')},toString:function(){return"Store"}})}),define("blue/store/enumerable",["require","../store","../declare"],function(e){"use strict";var t=e("../store");return e("../declare")(t,{constructor:function(e){t.call(this,e)},forEach:function(){throw new Error('"forEach()" is not implemented')},keys:function(){throw new Error('"keys()" is not implemented')}})}),define("blue/store/enumerable/memory",["require","../enumerable","blue/declare","blue/perf"],function(e){"use strict";var t=e("../enumerable"),n=e("blue/declare"),r=e("blue/perf");return n(t,{constructor:function(e,n,o){n=n||{_type:"memory"},n._q=n._q||{},this.data=n[e]||(n[e]=new Map);var i=this,a=n._q[e]||(n._q[e]=[]),s=function(){for(var e;e=a[0];)o[e.method].apply(o,e.args||[]),a.shift()},u=function(){o.forEach(function(e,t){i.data.set(t,e)}),a.sync=!0},c=function(e,t){if(o)try{a[0]&&s(),!a.sync&&u(),e&&o[e].apply(o,t||[])}catch(n){e&&a.push({method:e,args:t})}};t.call(this,e),Object.defineProperty(this,"size",{get:function(){return r.count("blue/store",n._type,e,"size"),c(),this.data.size},enumerable:!0}),this.clear=function(){r.count("blue/store",n._type,e,"clear"),c("clear"),this.data.clear()},this.get=function(t){return r.count("blue/store",n._type,e,"get",t),c(),this.data.get(t)},this.set=function(t,o){r.count("blue/store",n._type,e,"set",t),c("set",[t,o]),this.data.set(t,o)},this.has=function(t){return r.count("blue/store",n._type,e,"has",t),c(),this.data.has(t)},this.remove=function(t){r.count("blue/store",n._type,e,"remove",t),c("remove",[t]),this.data.delete(t)},this.keys=function(){return r.count("blue/store",n._type,e,"keys"),c(),this.data.keys()},this.forEach=function(t,o){return r.count("blue/store",n._type,e,"forEach"),c(),this.data.forEach(t,o)},r.count("blue/store",n._type,e,"create")}})}),define("blue/routeHistory",["require","blue/as/contextual","blue/is","blue/store/enumerable/memory","blue/dom","blue/hash"],function(e){"use strict";function t(){return++p}function n(){return c.defined(f.title)?f.title:null}function r(e){c.defined(f.title)&&e&&(f.title=e)}function o(e,t){var n,r,o=d.getHash(),i=0;if(0===arguments.length?(e="site",t=1):1===arguments.length&&c.string(arguments[0])?t=1:1===arguments.length&&(t=e,e="site"),l.has(e)&&(n=l.get(e),n.length>0&&(r=n[0].url!==o,r&&(i=-1),t+i<n.length)))return n[t+i]}function i(e){l.forEach(function(t){for(;t.length&&t[0].id>e;)t.shift()})}function a(e,o,i){var a={id:t(),url:o,title:n(),titlePrefix:"",titleSuffix:""};e.length&&(e[0].titlePrefix||e[0].titleSuffix)&&a.title===e[0].titlePrefix+e[0].title+e[0].titleSuffix&&(a.title=e[0].title,r(a.title)),i?e[0]=a:e.unshift(a)}var s,u=e("blue/as/contextual"),c=e("blue/is"),l=new(e("blue/store/enumerable/memory"))("RouteHistory"),f=e("blue/dom"),d=e("blue/hash"),p=0;return s=function(e,t){this.name=e,this.defineContext(t),l.set("site",[])},s.prototype=Object.create(null),s.prototype.constructor=s,s.prototype.saveRoute=function(e,t,n){var r,o,i=t||d.getHash();e=e||"site",n=!!n,l.has(e)||l.set(e,[]),r=l.get(e),r.length&&r[0].url===i||("site"===e||t!==d.getHash()?a(r,i,n):(o=l.get("site")[0])!==r[0]&&r.unshift(o))},s.prototype.lastRoute=function(){var e=o.apply(this,arguments);if(e)return e.url},s.prototype.getHistory=function(){var e=o.apply(this,arguments);if(e)return e},s.prototype.goBack=function(){var e=o.apply(this,arguments);e&&(i(e.id),r(e.titlePrefix+e.title+e.titleSuffix),d.setHash(e.url))},s.prototype.updateRouteTitle=function(e){var t=l.get("site");t[0]?(t[0].title=e,r(t[0].titlePrefix+e+t[0].titleSuffix)):r(e)},s.prototype.updateRouteTitlePrefix=function(e){var t=l.get("site");e=e||"",t[0]&&(t[0].titlePrefix=e,r(t[0].titlePrefix+t[0].title+t[0].titleSuffix))},s.prototype.updateRouteTitleSuffix=function(e){var t=l.get("site");e=e||"",t[0]&&(t[0].titleSuffix=e,r(t[0].titlePrefix+t[0].title+t[0].titleSuffix))},s.prototype.toString=function(){return" Route History "},s=u.call(s,{name:"routeHistory"})}),define("blue/site",["require","blue/as/contextual","blue/as/registry","blue/importer","blue/compose","blue/log","blue/hash","blue/is","blue/perf","blue/resolver/module","blue/context/root","blue/router","blue/routeHistory"],function(e){"use strict";function t(){var e=Object.keys(y);return 1===e.length?e[0]:""}function n(e,t,n){Object.keys(y).forEach(function(r){e.registry&&e.registry.hasApplication&&e.registry.hasApplication(r)?e.registry.getApplication(r).then(function(e){e.context.emit(t,n)}):y[r]&&y[r].then(function(e){e.context.emit(t,n)})})}function r(e,t){return t.routeHandler.mappings&&t.routeHandler.mappings.length||t.addRouteMapping("IdentityMapping"),t}var o,i=e("blue/as/contextual"),a=e("blue/as/registry"),s=e("blue/importer"),u=e("blue/compose"),c=e("blue/log"),l=e("blue/hash"),f=e("blue/is"),d=e("blue/perf"),p=e("blue/resolver/module"),h=new p,m=e("blue/context/root"),g=e("blue/router"),b=e("blue/routeHistory"),v=c("[blue:core]"),y={},x={};return h.prefix="",h.suffix="",o=function(e,r){var o=this,i=0;this.name=e,this.defineContext(r,{name:"SITE",logger:c("[site]"),emitChildren:function(){var e=arguments;this.children&&this.children.forEach(function(t){t.emit.apply(t,e)})},env:Object.create(r.env||null)}),this.context._internal={},this.context.router=new g("router",this.context),this.context.routeHistory=new b("routeHistory",this.context),this.defaultAppName="",this.context.on("bootRouter",function(){o.bootRouter()}),this._pageQ=[],this.tellPage=function(){o._pageQ.push(arguments)},this.context._internal.importer=new s(this),this.context._internal.import=function(e,t,n){var r;return f.string(t)?(r={},r[t]=n):r=t,o.context._internal.importer.applyImports(e,r)},this.context.on("processRoute",function(e){var n=e.segments.shift()||{},r=n.name||o.defaultAppName||t();y[r]&&(e.routeId=++i,e.onSuccess=[],!n.name&&l.addSegmentToCurrentHash(r),o.registry&&o.registry.getApplication?o.registry.getApplication(r).then(function(t){e.segmentParams=n.params,t.context.emit("blue:route:routeRequest",e)}):y[r].then(function(t){e.segmentParams=n.params,t.context.emit("blue:route:routeRequest",e)}))}),this.context.on("blue:route",function(e){"blue:route:newRouteRequest"!==e.msgType&&"blue:route:newRouteRequestAborted"!==e.msgType&&"blue:route:newRouteExecuting"!==e.msgType||n(o,e.msgType,e)})},o.prototype=Object.create(null),o.prototype.constructor=o,o.prototype.initialize=function(e){"function"==typeof e?e.call(this,this.context):u(this,e),"function"==typeof this.onInit?this.onInit():"function"==typeof this.init&&this.init()},o.prototype.defineApplication=function(e,t,n){var i=this;return i.registry&&i.registry.getApplication||(a.call(o.prototype,"application",e,{lazy:!0,onAfterCreate:r}),i.defineApplicationsRegistry(i.context)),i.context._internal.import(i,t,n)},o.prototype.startApplication=function(e,t){var n,r,o,i=this,a=new Promise(function(e,t){n=e,r=t});if(t&&e)return i.registry&&i.registry.getApplication?o=i.registry.getApplication(t):y[t]||(o=this.createApplication(e,t)),o.then(function(e){var a;i.context.logger.debug("created new default application"),i.tellApp=e.context.emit.bind(e.context),a=i.context._internal.importer.isImport(e.context.getStack())?Promise.resolve():e.loadSpec(),a.then(function(){var i;y[t]=o,f.function(e.onLoad)&&(i=e.onLoad()),i&&f.thenable(i)?i.then(function(){f.function(e.afterOnLoad)&&e.afterOnLoad(),e.tellPage=function(){},n(e)},function(e){r(e)}):(f.function(e.afterOnLoad)&&e.afterOnLoad(),e.tellPage=function(){},n(e))})}),a.then(function(e){e.context.broadcast("blue:applicationComplete")}),a},o.prototype.startPage=function(e,t){var n,r,o=this,i=new Promise(function(e,t){n=e,r=t});if(t&&e)return x[t]||o.createPage(e,t),x[t].then(function(e){e.loadSpec().then(function(){var t;f.function(e.onLoad)&&(t=e.onLoad()),t&&f.thenable(t)?t.then(function(){e.tellApp=function(){},n(e)},function(e){r(e)}):(e.tellApp=function(){},n(e))})},function(e){var n={},i={};v.fatal("["+o.context.getStack()+"]","Failed to load Page ("+t+")",e),i.code="blue:site:error:pageLoadError",i.description="Failed to load Page ("+t+"): "+e,o.context.broadcast(i.code,i),o.context.is.empty(y)&&(n=o.context.util.object.deepClone(i),n.code="blue:error:site:pageLoadError",o.context.emit(n.code,n)),r(e)}),i},o.prototype.createApplication=function(e,t){var n=this,r=t+"/"+t,o=this.context,i=new Promise(function(i,a){var s=new Promise(function(t){h.resolve(e).onValue(function(e){t(e)})}),c=new Promise(function(e){h.resolve(r).onValue(function(t){e(t)})});Promise.all([s,c]).then(function(e){var r,s=e[0],c=e[1];s&&c||a(new Error("Unable to load Application modules")),r=new s(t,o),u(r,c),f.function(r.onInit)?r.onInit():f.function(r.init)&&r.init(),n.tellApp=r.context.emit.bind(r.context),f.function(r.onPerf)&&(d.handler=r.onPerf.bind(r)),i(r)}).catch(function(e){a(e)})});return y[t]=i,i},o.prototype.createPage=function(e,t){var n=this,r=this.context,o=new Promise(function(o,i){var a=new Promise(function(t){h.resolve(e).onValue(function(e){t(e)})}),s=new Promise(function(e){h.resolve(t).onValue(function(t){e(t)})});Promise.all([a,s]).then(function(e){var a,s=e[0],c=e[1];s&&c||i(new Error("Unable to load Page modules")),a=new s(t,r),u(a,c),f.function(a.onInit)?a.onInit():f.function(a.init)&&a.init(),n.tellPage=a.context.emit.bind(a.context),n._pageQ&&(n._pageQ.forEach(function(e){n.tellPage.apply(n,e)}),delete n._pageQ),o(a)}).catch(function(e){i(e)})});return x[t]=o,o},o.prototype.wireAppPage=function(e,t){e&&t&&(e.tellPage=t.context.emit.bind(t.context),t.tellApp=e.context.emit.bind(e.context),e.tellPage("application:ready"),t.tellApp("page:ready"))},o.prototype.bootRouter=function(e){this.context.router.init(e),this.context.router.hashChangeListen(),this.context.router.handleInitialRoute()},new(o=i.call(o,{name:"site"}))("site",m)}),define("blue/dom/title",["require","../dom","../site"],function(e){"use strict";var t=e("../dom"),n=e("../site"),r=n.context.routeHistory;return function(){this.getTitle=function(){return t.title},this.setTitle=function(e){r.updateRouteTitle(e)},this.getPrefix=function(){var e=r.getHistory(0);return e?e.titlePrefix:""},this.setPrefix=function(e){r.updateRouteTitlePrefix(e)},this.getSuffix=function(){var e=r.getHistory(0);return e?e.titleSuffix:""},this.setSuffix=function(e){r.updateRouteTitleSuffix(e)},this.clearPrefix=function(){r.updateRouteTitlePrefix()},this.clearSuffix=function(){r.updateRouteTitleSuffix()}}}),define("blue/event/channel/domEvents",["require","../../event","../../is","../channel"],function(e){"use strict";function t(e,t,n){t.forEach(function(t){e.addEventListener(t,n.bind(e))})}function n(e){var t=new r(e,{type:e.type,target:this});i.emit(t)}var r=e("../../event"),o=e("../../is"),i=new(e("../channel")),a=["click","keydown","keyup","resize","scroll","beforeunload"],s=["click","scroll"];return o.defined(document)&&t(document,s,n),o.defined(window)&&t(window,a,n),i}),define("blue/event/channel/analytics",["require","../channel","./component","./domEvents","../../device","../../dom/dimensions","../../device/lang"],function(e){"use strict";var t=new(e("../channel")),n=e("./component"),r=e("./domEvents"),o={},i=e("../../device"),a=e("../../dom/dimensions"),s=e("../../device/lang"),u=r.asEventStream("beforeunload"),c=n.asEventStream().merge(u);return c.onValue(function(e){return e.identity={device:i},e.identity.device.dimensions.window=a(),e.location=o,e.language=s,e}),t.plug(c),t}),define("blue/event/channel/controller",["require","../channel"],function(e){"use strict";return new(e("../channel"))}),"WeakMap"in window||function(e){"use strict";function t(){var e=[],t=[];return b(h,{delete:{value:g.call(n,u,c,e,t)},get:{value:g.call(r,u,c,e,t)},has:{value:g.call(o,u,c,e,t)},set:{value:g.call(i,u,c,e,t)}})}function n(e,t,n,r){return o(e,t,n,r)&&(t.splice(d,1),n.splice(d,1)),-1<d}function r(e,t,n,r){return o(e,t,n,r)?n[d]:f}function o(e,t,n,r){if(e&&r!==p(r))throw new TypeError("not a non-null object");return-1<(d=a.call(t,r))}function i(e,t,n,r,i){o(e,t,n,r)?n[d]=i:n[t.push(r)-1]=i}function a(e){if(e!=e||0===e)for(d=this.length;d--&&!m(this[d],e););else d=v.call(this,e);return d}function s(){}var u=null,c=!0,l="undefined"==e;l||(window=global);var f,d,e=l?{}:exports,p=window.Object,h=t.prototype,m=(p.defineProperty,p.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}),g=t.bind||function(e,t,n,r){var o=this;return function(i,a){return o.call(e,t,n,r,i,a)}},b=p.create||function(e,t){s.prototype=e;var n,r=new s;for(n in t)r[n]=t[n].value;return r},v=[].indexOf||function(e){for(d=this.length;d--&&this[d]!==e;);return d};t.prototype=h=t(),window.WeakMap=e.WeakMap=window.WeakMap||t}.call(this,typeof exports),define("blue/fill/WeakMap",function(){}),define("blue/$",["require","jquery"],function(e){"use strict";return e("jquery")}),define("blue/fill/dom/event",["require","../../is","../../dom"],function(e){"use strict";var t=e("../../is"),n=e("../../dom");return function(e,r){if(t.undefined(e))throw new Error("Not enough arguments");t.undefined(r)&&(r={});var o=n.createEventObject();return o.type=e,o.bubbles=!!t.boolean(r.bubbles)&&r.bubbles,o.cancelable=!!t.boolean(r.cancelable)&&r.cancelable,o}}),define("blue/fill/dom/addEventListener",["require","../../has/all","../../is","../../dom/body"],function(e){"use strict";var t=e("../../has/all"),n=e("../../is"),r=e("../../dom/body");return function(e,o){var i=this;n.undefined(i._events)&&(i._events={}),n.function(i._events[e])||(i._events[e]=function(e){var t,n=i._events[e.type].list,o=n.slice(),a=-1,s=o.length;for(e.preventDefault=function(){!1!==e.cancelable&&(e.returnValue=!1)},e.stopPropagation=function(){e.cancelBubble=!0},e.stopImmediatePropagation=function(){e.cancelBubble=!0,e.cancelImmediate=!0},e.currentTarget=i,e.relatedTarget=e.fromElement||null,e.target=e.srcElement||i,e.timeStamp=(new Date).getTime(),e.clientX&&(e.pageX=e.clientX+r.scrollLeft,e.pageY=e.clientY+r.scrollTop);++a<s&&!e.cancelImmediate;)a in o&&(t=o[a],-1!==n.indexOf(t)&&t.call(i,e))},i._events[e].list=[],t("element-attachEvent")?i.attachEvent("on"+e,i._events[e]):i["on"+e]=i._events[e]),i._events[e].list.push(o)}}),define("blue/fill/dom/removeEventListener",["require","../../has/all","../../is"],function(e){"use strict";var t=(e("../../has/all"),e("../../is"));return function(e,n){var r=this;if(t.plainObject(r._events)&&t.function(r._events[e])&&t.array(r._events[e].list)){var o=r._events[e].list.indexOf(n);-1!==o&&(r._events[e].list.splice(o,1),r._events[e].list.length||delete r["on"+e])}}}),define("blue/fill/getComputedStyle",[],function(){"use strict";function e(t,n,r){t.document;var o,i=t.currentStyle[n].match(s)||[0,0,""],c=i[1],l=i[2];return r=r?a.test(l)&&t.parentElement?e(t.parentElement,"fontSize",null):16:r,o="fontSize"===n?r:u.test(n)?t.clientWidth:t.clientHeight,"%"===l?c/100*o:"cm"===l?.3937*c*96:"em"===l?c*r:"in"===l?96*c:"mm"===l?.3937*c*96/10:"pc"===l?12*c*96/72:"pt"===l?96*c/72:c}function t(e,t){var n="border"===t?"Width":"",r=t+"Top"+n,o=t+"Right"+n,i=t+"Bottom"+n,a=t+"Left"+n;e[t]=(e[r]===e[o]&&e[r]===e[i]&&e[r]===e[a]?[e[r]]:e[r]===e[i]&&e[a]===e[o]?[e[r],e[o]]:e[a]===e[o]?[e[r],e[o],e[i]]:[e[r],e[o],e[i],e[a]]).join(" ")}function n(n){var a=this,s=n.currentStyle,u=e(n,"fontSize"),c=function(e){return"-"+e.toLowerCase()};for(var l in s)if(s.hasOwnProperty(l))if(Array.prototype.push.call(a,"styleFloat"===l?"float":l.replace(o,c)),"width"===l)a[l]=n.offsetWidth+"px";else if("height"===l)a[l]=n.offsetHeight+"px";else if("styleFloat"===l)a.float=s[l];else if(r.test(l)&&"auto"!==a[l])a[l]=Math.round(e(n,l,u))+"px";else if(i.test(l))try{a[l]=s[l]}catch(e){a.outlineColor=s.color,a.outlineStyle=a.outlineStyle||"none",a.outlineWidth=a.outlineWidth||"0px",a.outline=[a.outlineColor,a.outlineWidth,a.outlineStyle].join(" ")}else a[l]=s[l];t(a,"margin"),t(a,"padding"),t(a,"border"),a.fontSize=Math.round(u)+"px"}var r=/margin.|padding.|border.+W/,o=/[A-Z]/,i=/^outline/,a=/%|em/,s=/([\d\.]+)(%|cm|em|in|mm|pc|pt|)/,u=/width/i;return n.prototype={constructor:n,getPropertyPriority:function(){throw new Error("NotSupportedError: DOM Exception 9")},getPropertyValue:function(e){return this[e.replace(/-\w/g,function(e){return e[1].toUpperCase()})]},item:function(e){return this[e]},removeProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},setProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},getPropertyCSSValue:function(){throw new Error("NotSupportedError: DOM Exception 9")}},function(e){return new n(e)}}),define("blue/fill/matchMedia",["require","../has/detect","../is","../root","../dom/createElement","../dom"],function(e){"use strict";var t,n=e("../has/detect"),r=e("../is"),o=e("../root"),i=e("../dom/createElement"),a=e("../dom");if(n("stylemedia")&&(t=o.styleMedia),n("media")&&(t=o.media),r.undefined(t)){var s=i("style"),u=a.getElementsByTagName("script")[0],c=null;s.type="text/css",s.id="matchmediajs-test",u.parentNode.insertBefore(s,u),c=getComputedStyle(s,null),t={matchMedium:function(e){var t="@media "+e+"{ #matchmediajs-test { width: 1px; } }";return s.textContent=t,"1px"===c.width}}}return function(e){return!r.string(e)&&(e="all"),{matches:t.matchMedium(e),media:e}}}),define("blue/fill",["require","blue/device","es6shim","webcrypto-shim","blue/fill/WeakMap","blue/$","blue/has/all","blue/root","blue/is","mout/array/every","mout/array/filter","mout/array/forEach","mout/array/indexOf","mout/array/lastIndexOf","mout/array/map","mout/array/reduce","mout/array/reduceRight","mout/array/some","mout/function/bind","blue/dom","blue/fill/dom/event","blue/fill/dom/addEventListener","blue/fill/dom/removeEventListener"],function(e){"use strict";e("blue/device"),e("es6shim"),e("webcrypto-shim"),e("blue/fill/WeakMap");var t,n,r=e("blue/$"),o=e("blue/has/all"),i=e("blue/root"),a=(e("blue/is"),e("mout/array/every")),s=e("mout/array/filter"),u=e("mout/array/forEach"),c=(e("mout/array/indexOf"),e("mout/array/lastIndexOf")),l=e("mout/array/map"),f=e("mout/array/reduce"),d=e("mout/array/reduceRight"),p=e("mout/array/some"),h=e("mout/function/bind"),m=(e("blue/dom"),e("blue/fill/dom/event"),e("blue/fill/dom/addEventListener"),e("blue/fill/dom/removeEventListener"),function(){t=!0,clearTimeout(n),n=setTimeout(function(){t=!1},300)}),g=function(e,t){var n;try{n=new i.MouseEvent(t,{bubbles:!0,cancelable:!0,view:i,button:0}),e.dispatchEvent(n)}catch(r){document.createEvent?(n=document.createEvent("MouseEvent"),n.initMouseEvent(t,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(n)):document.createEventObject&&(n=document.createEventObject(i.event),n.button=1,e.fireEvent("on"+t,n))}};o("array-every")||(Array.prototype.every=function(){return a.apply(this,arguments)}),o("array-filter")||(Array.prototype.filter=function(){return s.apply(this,arguments)}),o("array-foreach")||(Array.prototype.forEach=function(){return u.apply(this,arguments)}),o("array-lastindexof")||(Array.prototype.lastIndexOf=function(){return c.apply(this,arguments)}),o("array-map")||(Array.prototype.map=function(){return l.apply(this,arguments)}),o("array-reduce")||(Array.prototype.reduce=function(){return f.apply(this,arguments)}),o("array-reduceright")||(Array.prototype.reduceRight=function(){return d.apply(this,arguments)}),o("array-some")||(Array.prototype.some=function(){return p.apply(this,arguments)}),o("date-now")||(Date.now=function(){return(new Date).getTime()}),o("function-bind")||(Function.prototype.bind=function(){return h.apply(this,arguments)});document&&document.body&&(r(document.body).on("mouseup touchend pointerup MSPointerUp",m),r(document.body).click(function(e){t||(i.PointerEvent?(g(e.target,"pointerdown"),g(e.target,"pointerup"),g(e.target,"pointercancel")):i.MSPointerEvent?(g(e.target,"MSPointerDown"),g(e.target,"MSPointerUp"),g(e.target,"MSPointerCancel")):(g(e.target,"mousedown"),g(e.target,"mouseup")))}))}),define("blue/store/enumerable/cookie",["require","blue/store/enumerable","blue/has/all","blue/dom","blue/declare","blue/root"],function(e){"use strict";var t=e("blue/store/enumerable"),n=(e("blue/has/all"),e("blue/dom")),r=e("blue/declare"),o=e("blue/root"),i=function(e){return["store",e].join("~")+"~"},a=function(e,t){return"anonymous"===e?t:["store",e,t].join("~")},s=function(e,t){return t?e:encodeURIComponent(e)},u=function(e,t){return t?e:decodeURIComponent(e)};return r(t,function(){var e={getItem:function(e,t){return u(n.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+s(e,t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"),t)||null},setItem:function(e,t,r,o,i,a,u){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(r)switch(r.constructor){case Number:c=r===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+r;break;case String:c="; expires="+r;break;case Date:c="; expires="+r.toUTCString()}return n.cookie=s(e,u)+"="+s(t,u)+c+(i?"; domain="+i:"")+(o?"; path="+o:"")+(a?"; secure":""),!0},removeItem:function(e,t,r,o){return!(!e||!this.hasItem(e))&&(n.cookie=s(e,o)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(r?"; domain="+r:"")+(t?"; path="+t:""),!0)},hasItem:function(e,t){return new RegExp("(?:^|;\\s*)"+s(e,t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(n.cookie)},keys:function(e){for(var t=n.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),r=0;r<t.length;r++)t[r]=u(t[r],e);return t}};return{constructor:function(n,r,o,s,u,c){null===n&&(n="anonymous"),t.call(this,n),this.ids=new Set,this.size=0,this.raw=r,this.end=o,this.path=s,this.domain=u,this.secure=c,this.namespace=i(this.name),this.getId=a.bind(this,this.name);for(var l=e.keys(this.raw),f=0;f<l.length;f++){var d=l[f];"anonymous"!==n&&0!==d.indexOf(this.namespace)||this.ids.has(d)||(this.ids.add(d),this.size++)}},clear:function(){this.keys().forEach(function(e){this.remove(e)}.bind(this))},forEach:function(e,t){this.keys().forEach(function(n){e.call(t||o,this.get(n),n,this)},this)},get:function(t){var n=e.getItem(this.getId(t),this.raw);return n?this.raw?n:JSON.parse(n):void 0},has:function(e){return this.ids.has(this.getId(e),this.raw)},keys:function(){var e=[];return this.ids.forEach(function(t){e.push(t.split("~").pop())}),e},set:function(t,n,r,o,i,a){var s=this.getId(t);this.ids.has(s)||this.ids.add(s),e.setItem(s,this.raw?n:JSON.stringify(n),r||this.end,o||this.path,i||this.domain,a||this.secure,this.raw),this.size++},remove:function(t,n,r){var o=this.getId(t);this.ids.has(o)&&(this.ids.delete(o),e.removeItem(o,n||this.path,r||this.domain,this.raw),this.size--)}}})}),define("blue/intercept/cache",["meld/aspect/cache"],function(e){"use strict";return e}),define("blue/queue",["require","blue/log","./declare"],function(e){"use strict";var t=new(e("blue/log"))("[queue]");return e("./declare")(function(){var e=function(e){return new Promise(function(t,n){try{e(t)}catch(e){n(e)}})},n=function(e){return e(function(){}),Promise.resolve()};return{constructor:function(e){e=e||"sync",this.q=[],this.sync="sync"===e,this.running=!1},execQ:function(){var e,n,r=this;r.running||void 0===r.q[0]||(r.running=!0,e=r.q.shift(),n=e(),n.then(function(){r.running=!1,r.execQ()}).catch(function(e){throw r.running=!1,r.execQ(),e}).catch(function(e){throw t.warn("Queue execution encountered an error",e),e}))},idle:function(){return!this.running&&void 0===this.q[0]},busy:function(){return this.running||void 0!==this.q[0]},add:function(t){this.sync?this.q.push(e.bind(void 0,t)):this.q.push(n.bind(void 0,t)),this.execQ()}}})}),define("blue/resource",["require","./is","./declare"],function(e){"use strict";var t=e("./is");return e("./declare")({constructor:function(e){if(!t.string(e))throw new TypeError('"name" is not a string');this.name=e},destroy:function(){throw new Error('"destroy()" is not implemented')},read:function(e){throw new Error('"read()" is not implemented')},update:function(e){throw new Error('"update()" is not implemented')},toString:function(){return"Resource"}})}),define("blue/string/parsePipedList",["require","../is","../root"],function(e){"use strict";var t=e("../is"),n=e("../root").unescape,r=function(e,t){if(-1!==e.indexOf(t)){var n=e.charAt(e.length-1)===t,r=n&&e.charAt(e.length-2)===t;return(n&&!r?e.substring(0,e.length-1):e).split(t)}return e};return function(e){for(var o=r(n(e),"|"),i={},a=0,s=o.length;a<s;a++){var u=o[a].split("="),c=u[0],l=r(decodeURIComponent(u[1]),"&");if(t.array(l))for(var f=0,d=l.length;f<d;f++){var p=l.shift();p=p.split(","),l.push(p)}else l=r(l,",");i[c]=l}return i}}),define("blue/object/toPipedList",["require","../is","../log","../root"],function(e){"use strict";var t=e("../is"),n=e("../log")("[app]"),r=e("../root").escape,o=function(e,n){return t.array(e)?e.join(n)+n:e};return function(e,i){var a,s,u,c,l=[];return t.function(i)||(i=function(){return!0}),Object.keys(e).forEach(function(f){var d=e[f];if(a=t.array(d),s=a&&!!d.length&&t.array(d[0]),u=i(f,d)){if(s){for(var p=0,h=d.length;p<h;p++){var m=d.shift();m=m.join(","),d.push(m)}d=o(d,"&")}a&&(d=o(d,",")),c=s?r(f+"=")+d:r(f+"="+encodeURIComponent(d)),l.push(c)}else n.error("Invalid key or value:",f+"="+d)}),o(l,"|")}}),define("blue/resource/persona",["require","../is","../has/detect","../root","../resource","../store/enumerable/cookie","../log","moment","../string/parsePipedList","../object/toPipedList","../declare"],function(e){"use strict";var t=(e("../is"),e("../has/detect")),n=e("../root"),r=e("../resource"),o=e("../store/enumerable/cookie"),i=e("../log")("[app]"),a=e("moment"),s=e("../string/parsePipedList"),u=e("../object/toPipedList"),c=e("../declare"),l=new Date,f=(l.setDate(l.getDate()+365),n.location&&n.location.hostname?n.location.hostname:""),d=""===f?"":"localhost"===f?"localhost":".chase.com",p=new o(null,!0,l,"/",d),h=function(e,t){e=e.split(" ");for(var n=0,r=e.length;n<r;n++)void 0!==t[e[n]]&&delete t[e[n]]},m=function(){return t("date-toisostring")?(new Date).toISOString().split("T")[0]:a.format("YYYY-MM-DD")},g=function(e){var t={};if(e)for(var n=0,r=e.length;n<r;n++){var o=e[n];t[o[0]]={},t[o[0]].uratc=o[1],t[o[0]].rwdb=o[2]}return t},b=s,v=function(e,t,n){var r=n[e];if(r)for(var o=0,i=r.length;o<i;o++)if(t===r[o])return"Y";return"N"},y=u,x=function(e,t){return!0};return c(r,function(){return{constructor:function(e){e=e||"PC_1_0",r.call(this,e)},destroy:function(){p.remove(this.name)},read:function(e){e=e||!1;var t,n=p.get(this.name);if(e)t=n;else if(n)try{n=b(n),n.pplr=v("ppl","A",n),n.fieir=v("fiei","Y",n),n.fpeir=v("fpei","Y",n),n.sieir=v("siei","Y",n),n.tieir=v("tiei","Y",n),n.accounts=g(n.accts),t=n}catch(e){i.error("Unable to read Persona resource:",this.name,". Error:",e)}return t},update:function(e){try{var t=m();"string"==typeof e&&(e=b(e)),e.lastUpdate=t,e.lastSent=e.lastSent||e.lastUpdate,e.segment&&e.seg&&delete e.seg,h("fieir fpeir pplr sieir tieir accounts",e),e=y(e,x),p.set(this.name,e)}catch(t){i.error("Unable to update Persona resource:",this.name,"=",e,". Error:",t)}},toString:function(){return"Persona"}}})}),define("blue/store/enumerable/localUnbuffered",["require","blue/store/enumerable","blue/root","blue/declare"],function(e){"use strict";var t,n=e("blue/store/enumerable"),r=e("blue/root"),o=e("blue/declare"),i=function(){},a=function(e){return["store",e].join("~")+"~"},s=function(e,t){return["store",e,t].join("~")};try{t=r.localStorage,t.length}catch(e){t={length:0,getItem:i,removeItem:i,setItem:i}}return o(n,function(){return{constructor:function(e){n.call(this,e),this.ids=new Set,this.size=0,this.namespace=a(this.name),this.getId=s.bind(this,this.name);for(var r=0;r<t.length;r++){var o=t.key(r);0!==o.indexOf(this.namespace)||this.ids.has(o)||(this.ids.add(o),this.size++)}},clear:function(){this.keys().forEach(this.remove.bind(this))},forEach:function(e,t){this.keys().forEach(function(n){e.call(t||r,this.get(n),n,this)},this)},get:function(e){
var n=t.getItem(this.getId(e));return n&&"undefined"!==n?JSON.parse(n):void 0},has:function(e){return this.ids.has(this.getId(e))},keys:function(){var e=[];return this.ids.forEach(function(t){e.push(t.split("~").pop())}),e},set:function(e,n){var r=this.getId(e);this.ids.has(r)||this.ids.add(r),t.setItem(r,JSON.stringify(n)),this.size++},remove:function(e){var n=this.getId(e);this.ids.has(n)&&(this.ids.delete(n),t.removeItem(n),this.size--)}}})}),define("blue/store/enumerable/local",["require","./localUnbuffered","./memory"],function(e){"use strict";var t=e("./localUnbuffered"),n=e("./memory"),r={_type:"local"};return function(e){return new n(e,r,new t(e))}}),define("blue/store/enumerable/sessionUnbuffered",["require","../enumerable","blue/root","blue/declare","blue/has"],function(e){"use strict";var t=e("../enumerable"),n=e("blue/root"),r=e("blue/declare"),o=e("blue/has"),i=function(e){return["store",e].join("~")+"~"},a=function(e,t){return["store",e,t].join("~")};return r(t,function(){return{constructor:function(e){if(t.call(this,e),this.ids=new Set,this.size=0,this.namespace=i(this.name),this.getId=a.bind(this,this.name),o("sessionstorage"))for(var n=0;n<sessionStorage.length;n++){var r=sessionStorage.key(n);0!==r.indexOf(this.namespace)||this.ids.has(r)||(this.ids.add(r),this.size++)}},clear:function(){this.keys().forEach(this.remove.bind(this))},forEach:function(e,t){this.keys().forEach(function(r){e.call(t||n,this.get(r),r,this)},this)},get:function(e){var t=o("sessionstorage")?sessionStorage.getItem(this.getId(e)):void 0;return t&&"undefined"!==t?JSON.parse(t):void 0},has:function(e){return this.ids.has(this.getId(e))},keys:function(){var e=[];return this.ids.forEach(function(t){e.push(t.split("~").pop())}),e},set:function(e,t){var n=this.getId(e);this.ids.has(n)||this.ids.add(n),o("sessionstorage")&&sessionStorage.setItem(n,JSON.stringify(t)),this.size++},remove:function(e){var t=this.getId(e);this.ids.has(t)&&(this.ids.delete(t),o("sessionstorage")&&sessionStorage.removeItem(t),this.size--)}}})}),define("blue/store/enumerable/session",["require","./sessionUnbuffered","./memory"],function(e){"use strict";var t=e("./sessionUnbuffered"),n=e("./memory"),r={_type:"session"};return function(e){return new n(e,r,new t(e))}}),define("blue/settings",["require","blue/store/enumerable/local","blue/store/enumerable/session","blue/store/enumerable/cookie"],function(e){var t={local:e("blue/store/enumerable/local"),session:e("blue/store/enumerable/session"),cookie:e("blue/store/enumerable/cookie")},n=Object.prototype.hasOwnProperty;return new function(e){var r,o,i,a=this,s=null,u={},c={};for(a.Type={},i=1;i<arguments.length;i++)!function(i){var l,f,d,p=i.name,h=t[i.type],m=function(e){Object.defineProperty(d,e,{get:function(){return h.get(e)},set:function(t){h.set(e,t)},configurable:!0,enumerable:!0})};if(a.Type[p]=p,c[p]={clearable:i.clearable,set:h?function(e,t){n.call(d,e)||m(e),d[e]=t}:function(e,t){d[e]=t},remove:h?function(e){h.remove(e),delete d[e]}:function(e){delete d[e]},clear:h?function(){h.clear(),Object.keys(d).forEach(function(e){delete d[e]})}:function(){Object.keys(d).forEach(function(e){delete d[e]})}},u[p]=d=s=Object.create(s),h)for(h=h([e,p].join("~")),l=h.keys();f=l.next().value;)m(f);o=p,i.default&&(r=p)}(arguments[i]);r=r||o,a.clear=function(e){c[e].clearable&&c[e].clear()},a.get=function(e,t){return t?n.call(u[t],e)?u[t][e]:void 0:u[r][e]},a.has=function(e,t){return t?n.call(u[t],e):e in u[r]},a.set=function(e,t,n){var o,i;switch((e||1).constructor){case String:c[n||r].set(e,t);break;case Object:i=c[t||r].set;for(o in e)i(o,e[o])}},a.remove=function(e,t){c[t||r].remove(e)}}("settings",{name:"SITE"},{name:"APP"},{name:"ENV",clearable:!0},{name:"USER",clearable:!0},{name:"PERM"},{name:"TEMP",clearable:!0,default:!0})}),define("blue/siteData",["require","exports","module","./is"],function(e,t,n){"use strict";var r=n.config(),o=e("./is"),i=o.plainObject(r)?r:{};return{setData:function(e,t){i[e]=t},getData:function(e){return o.defined(i[e])?i[e]:void 0}}}),define("blue/siteMode",["require","exports","module","./is"],function(e,t,n){"use strict";var r=n.config(),o=e("./is"),i=o.plainObject(r)?r:{};return{setMode:function(e,t){i[e]=t},isModeEnabled:function(e){return o.defined(i[e])&&!!i[e]}}}),define("blue/siteFeature",["require","exports","module","./is"],function(e,t,n){"use strict";var r=n.config(),o=e("./is"),i=o.plainObject(r)?r:{};return{setData:function(e,t){i[e]=t},getData:function(e){return o.defined(i[e])?i[e]:void 0}}}),define("blue/store/weakMemory",["require","blue/store","blue/declare"],function(e){"use strict";var t=e("blue/store");return e("blue/declare")(t,{constructor:function(e){t.call(this,e),this.data=new WeakMap,this.size=0},clear:function(){this.data=void 0,this.data=new WeakMap,this.size=0},get:function(e){return this.data.get(e)},has:function(e){return this.data.has(e)},set:function(e,t){this.data.set(e,t),this.size++},remove:function(e){this.data.has(e)&&(this.data.delete(e),this.size--)}})}),define("blue/wire/log",["require","../log","../log/level","../intercept","../is","stacktrace","../log/logger"],function(require){"use strict";function logStack(e){var t=printStackTrace({e:e});logger.error(t)}function time(e,t){var n;return n=timer(),"DEBUG "+("( total: "+(t?n.total+"ms, context: "+t():n)+" ): ")+e}function createTimer(){var e,t;return e=Date.now(),t=e,function(){var n,r,o;return n=Date.now(),r=n-e,o=n-t,t=n,{total:r,split:o,toString:function(){return o+"ms / "+r+"ms"}}}}function defaultFilter(e){return!!e}function createPathFilter(e){if(!e)return defaultFilter;var t=e.test?e:new RegExp(e);return function(e){return t.test(e)}}function logSeparator(){logger.debug("---------------------------------------------------")}var logger=require("../log")("[wire]"),Level=require("../log/level"),intercept=require("../intercept"),is=require("../is"),noop=function(){},printStackTrace=require("stacktrace"),reqLogLogger=require("../log/logger"),timer,defaultTimeout,createTracer,ownProp;return ownProp=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),timer=createTimer(),defaultTimeout=5e3,createTracer=function(){function e(e,t,n,r){logger.debug(e+t+(Date.now()-n.getTime())+"ms ): ",r)}function t(t){return{around:function(o){var i,a,s,u;u=r.substr(0,n),a=u+"DEBUG: "+t+"."+o.method,++n,logger.debug(a,o.args);try{return s=new Date,i=o.proceed(),e(a," RETURN ( ",s,i),i}catch(t){throw e(a," THROW ( ",s,t?t.toString():t),t}finally{--n}}}}var n,r,o,i;n=0,r=".";for(var a=0;a<8;a++)r+=r;return o="configure",i=/^[^_]/,function(e,n,r){function a(e,t){var n=reqLogLogger,r=e instanceof n;return is.object(e)&&is.function(e[t])&&"wire$plugin"!==t&&!r&&d.test(t)}function s(e){var t=[];if(is.node(e))return t;for(var n in e)a(e,n)&&t.push(n);return t}var u,c,l,f,d,p;f=e.trace.filter?createPathFilter(e.trace.filter):r,d=e.trace.pointcut||i,l=e.trace.step||o,p=[],u=function(e,n){f(e)&&p.push(intercept.add(n,s,t(e)))},c=function(){for(var e=p.length-1;e>=0;--e)p[e].remove()};var h=n[l]||function(e){e.resolve()};return n[l]=function(e,t,n){u(t.path,t.target),h(e,t,n)},{trace:u,untrace:c}}}(),function wireDebug(options){function contextTime(e){return time(e,contextTimer)}function makeListener(e,t){return function(n,r){cancelPathsTimeout();var o=r.path;if(paths[o]&&(paths[o].status=e),t&&filter(o)){var i=time(e+" "+(o||r.id||""),contextTimer);r.target?logger.debug(i,r.target,r.metadata):logger.debug(i,r)}count&&(checkPathsTimeout=setTimeout(checkPaths,timeout)),n.resolve()}}function cancelPathsTimeout(){clearTimeout(checkPathsTimeout),checkPathsTimeout=null}function checkPaths(){if(checkPathsTimeout){var e,t,n,r,o;if(logSeparator(),count){r=[],o=[],logger.error(tag+": No progress in "+timeout+"ms, status:");for(e in paths)t=paths[e],n=e+": "+t.status,("ready"==t.status?r:o).push({msg:n,metadata:t.metadata});if(o.length>0)for(logSeparator(),logger.debug("Components that DID NOT finish wiring"),e=o.length-1;e>=0;--e)t=o[e],logger.error(t.msg,t.metadata);if(r.length>0)for(logSeparator(),logger.debug("Components that finished wiring"),e=r.length-1;e>=0;--e)t=r[e],logger.debug(t.msg,t.metadata)}else logger.error(tag+": No components created after "+timeout+"ms");logSeparator()}}function makeConstructor(name,component){var ctor;try{name=name.replace(/^[^a-zA-Z$_]|[^a-zA-Z0-9$_]+/g,"_"),eval("ctor = function "+name+" (){}"),Object.defineProperty(component,"constructor",{configurable:!0,writable:!0,value:ctor})}catch(e){}}if(options.trace=logger.threshold.lessThan(Level.DEBUG),logger.threshold.greaterThan(Level.DEBUG))return{context:{error:function(e,t,n){logger.error(n&&n.message?n.message:n);var r=printStackTrace({e:n});logger.error("Stack Trace: \n",r.join?r.join("\n"):r),e.reject(n)}}};var contextTimer,timeout,paths,count,tag,logCreated,logDestroyed,checkPathsTimeout,verbose,filter,plugin,context,tracer;return verbose=options.verbose,contextTimer=createTimer(),count=0,tag="WIRING",tracer={trace:noop,untrace:noop},filter=createPathFilter(options.filter),logger.debug(contextTime("Context debug")),context={initialize:function(e){logger.debug(contextTime("Context init")),e.resolve()},ready:function(e){cancelPathsTimeout(),logger.debug(contextTime("Context ready")),e.resolve()},destroy:function(e){tracer.untrace(),logger.debug(contextTime("Context destroyed")),e.resolve()},error:function(e,t,n){cancelPathsTimeout(),logger.error(contextTime("Context ERROR: ")+n,n),logStack(n),e.reject(n)}},paths={},timeout=options.timeout||defaultTimeout,logCreated=makeListener("created",verbose),logDestroyed=makeListener("destroyed",!0),plugin={context:context,create:function(e,t){var n,r;n=t.path,r=t.target,count++,paths[n||"( unnamed-"+count+" )"]={metadata:t.metadata},r&&"object"==typeof r&&!ownProp(r,"constructor")&&makeConstructor(t.id,r),logCreated(e,t)},configure:makeListener("configured",verbose),initialize:makeListener("initialized",verbose),ready:makeListener("ready",!0),destroy:function(e,t){delete paths[t.path],count--,tag="DESTROY",logDestroyed(e,t)}},options.trace&&(tracer=createTracer(options,plugin,filter)),checkPathsTimeout=setTimeout(checkPaths,timeout),plugin}}),define("blue/main",function(){});
//# sourceMappingURL=../../../../../../sourcemap/blue-core/dist/2.19.1/blue/js/main.js.map
